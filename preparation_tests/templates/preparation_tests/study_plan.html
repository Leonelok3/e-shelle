{% extends "base.html" %}
{% load static %}

{% block title %}
Plan dâ€™Ã©tude {{ exam_code|upper }} | Immigration97
{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="{% static 'css/pages/study_plan.css' %}">
{% endblock %}

{% block content %}
<section class="page page-study-plan">

  <header class="page-title">
    <h1>ðŸ“… Plan dâ€™Ã©tude {{ exam_code|upper }}</h1>
    <p class="page-subtitle">
      Niveau {{ plan.level }} â€¢ Jour {{ plan.current_day }} / {{ plan.total_days }}
    </p>
  </header>

  <!-- ðŸ”µ BARRE DE PROGRESSION -->
  <div class="study-progress">
    <div class="study-progress__track">
      <div
        class="study-progress__fill"
        style="width: {{ plan.progress_percent }}%;">
      </div>
    </div>
    <span class="study-progress__label">
      {{ plan.progress_percent }}%
    </span>
  </div>

  <!-- ðŸ“… JOURS -->
  <div class="study-days">
    {% for day in plan.days %}
      <div class="study-day
        {% if day.is_current %}is-current{% endif %}
        {% if day.is_completed %}is-completed{% endif %}
      ">
        <div class="study-day__header">
          Jour {{ day.day }}
        </div>

        {% if day.lesson %}
          <div class="study-day__body">
            <strong>{{ day.section }}</strong><br>
            {{ day.lesson.title }}
          </div>
        {% else %}
          <div class="study-day__body muted">
            RÃ©vision / repos actif
          </div>
        {% endif %}
      </div>
    {% endfor %}
  </div>

  <!-- âœ… ACTION -->
  {% if not plan.is_completed %}
    <div class="study-actions">
      <a
        href="{% url 'preparation_tests:complete_study_day' exam_code %}"
        class="btn btn--primary">
        âœ… Marquer la journÃ©e comme terminÃ©e
      </a>
    </div>
  {% else %}
    <p class="success centered">
      ðŸŽ‰ Plan terminÃ© ! Tu peux recommencer ou viser un niveau supÃ©rieur.
    </p>
  {% endif %}

</section>
{% endblock %}
