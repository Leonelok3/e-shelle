{% extends "base.html" %}
{% load static %}

{# ==================================================
   SCOPE STRICT APP
================================================== #}
{% block body_class %}preparation-tests{% endblock %}
{% block app_scope %}preparation-tests{% endblock %}

{# ==================================================
   SEO ‚Äî TITLE & META
================================================== #}
{% block title %}
Historique Coach IA ‚Äì Analyses & Recommandations | Immigration97
{% endblock %}

{% block meta_description %}
Historique des analyses et recommandations g√©n√©r√©es par le Coach IA Immigration97.
Consulte tes rapports personnalis√©s par examen et comp√©tence linguistique.
{% endblock %}

{# ==================================================
   CSS APP ‚Äî VERSIONN√â
================================================== #}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/preparation_tests.css' %}?v=20260104">
{% endblock %}

{% block content %}

<!-- ==================================================
HERO ‚Äî HISTORIQUE COACH IA
================================================== -->
<section class="pt-hero">
  <div class="container pt-fade-up">

    <span class="pt-badge">
      ü§ñ Coach IA
    </span>

    <h1 class="pt-title">
      Historique des analyses<br>
      et recommandations
    </h1>

    <p class="pt-lead">
      Retrouve l‚Äôensemble des <strong>rapports g√©n√©r√©s par le Coach IA</strong>
      apr√®s tes entra√Ænements et examens.
      Chaque analyse t‚Äôaide √† identifier tes points forts,
      corriger tes faiblesses et progresser plus vite.
    </p>

  </div>
</section>

<!-- ==================================================
LISTE DES RAPPORTS
================================================== -->
<section class="pt-section">
  <div class="container">

    <div class="pt-grid-layout">

      <!-- ================= MAIN ================= -->
      <div class="pt-main">

        <h2 class="pt-section-title">
          üìÑ Rapports disponibles
        </h2>

        {% for r in reports %}
          <article class="pt-card pt-card--report">

            <!-- HEADER -->
            <div class="pt-report-header">
              <h3 class="pt-report-title">
                {{ r.exam_code }} ‚Äî
                <span class="pt-report-scope">
                  {{ r.scope|upper }}
                </span>
              </h3>

              <span class="pt-report-date">
                {{ r.created_at|date:"d M Y ¬∑ H:i" }}
              </span>
            </div>

            <!-- CONTENT -->
            <ul class="pt-report-list">
              {% for key, value in r.data.items %}
                <li>
                  <strong>{{ key }}</strong> :
                  {{ value }}
                </li>
              {% endfor %}
            </ul>

            <!-- ACTION -->
            <div class="pt-cta-group">
              <a
                href="{% url 'preparation_tests:coach_ai_pdf' r.id %}"
                class="pt-btn-secondary"
              >
                üìÑ T√©l√©charger le rapport PDF
              </a>
            </div>

          </article>

        {% empty %}
          <div class="pt-empty">
            Aucun rapport du Coach IA pour le moment.<br>
            Commence un entra√Ænement ou un examen blanc
            pour recevoir une analyse personnalis√©e.
          </div>
        {% endfor %}

      </div>

      <!-- ================= SIDEBAR ================= -->
      <aside class="pt-side">

        <div class="pt-card pt-card--side">
          <h3>√Ä quoi servent ces rapports ?</h3>

          <ul class="pt-side-list">
            <li>Analyser tes performances r√©elles</li>
            <li>Identifier tes points faibles</li>
            <li>Suivre ta progression CECR</li>
            <li>Optimiser ta strat√©gie d‚Äôexamen</li>
          </ul>

          <p class="pt-small">
            üí° Les rapports sont g√©n√©r√©s automatiquement
            apr√®s les examens blancs et certaines le√ßons avanc√©es.
          </p>
        </div>

      </aside>

    </div>

  </div>
</section>

{% endblock %}
