{% extends "base.html" %}
{% load static %}

{# ==================================================
   SCOPE STRICT APP
================================================== #}
{% block body_class %}preparation-tests{% endblock %}
{% block app_scope %}preparation-tests{% endblock %}

{# ==================================================
   SEO â€” TITLE & META
================================================== #}
{% block title %}
Examen blanc â€“ {{ session.exam.name }} | Immigration97
{% endblock %}

{% block meta_description %}
Examen blanc {{ session.exam.name }}
{% if session.section %}({{ session.section.code|upper }}){% endif %} :
conditions rÃ©elles, chronomÃ©trage, correction intelligente
et validation CECR avec Immigration97.
{% endblock %}

{# ==================================================
   CSS APP â€” VERSIONNÃ‰
================================================== #}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/preparation_tests.css' %}?v=20260104">
{% endblock %}

{% block content %}

<!-- ==================================================
HERO â€” EXAMEN BLANC
================================================== -->
<section class="pt-hero pt-hero--exam">
  <div class="container pt-fade-up">

    <span class="pt-badge pt-badge--exam">
      ðŸ§ª Examen blanc
    </span>

    <h1 class="pt-title">
      {{ session.exam.name }}
      {% if session.section %}
        <span class="pt-title-sub">
          â€” {{ session.section.code|upper }}
        </span>
      {% endif %}
    </h1>

    {% include "preparation_tests/partials/_cefr_bar.html" %}

    <p class="pt-lead">
      Conditions rÃ©elles dâ€™examen.
      Le <strong>chrono dÃ©marre</strong> dÃ¨s le dÃ©but
      et aucune pause nâ€™est possible.
    </p>

  </div>
</section>

<!-- ==================================================
INFOS SESSION
================================================== -->
<section class="pt-section">
  <div class="container">

    <article class="pt-card pt-card--session-info">

      <div class="pt-info-grid">

        <div>
          <span class="pt-info-label">Mode</span>
          <span class="pt-info-value">Examen blanc</span>
        </div>

        <div>
          <span class="pt-info-label">Section</span>
          <span class="pt-info-value">
            {% if session.section %}
              {{ session.section.code|upper }}
            {% else %}
              Toutes sections
            {% endif %}
          </span>
        </div>

        <div>
          <span class="pt-info-label">Questions</span>
          <span class="pt-info-value">
            {{ questions|length }}
          </span>
        </div>

        <div>
          <span class="pt-info-label">DurÃ©e</span>
          <span class="pt-info-value">
            {% if duration %}{{ duration }} s{% else %}â€”{% endif %}
          </span>
        </div>

      </div>

    </article>

  </div>
</section>

<!-- ==================================================
QUESTIONS â€” EXAMEN
================================================== -->
<section class="pt-section pt-section--exam">
  <div class="container">

    {% if questions %}
    <form method="post" class="pt-exam-form">
      {% csrf_token %}

      {% for question in questions %}
      <article class="pt-card pt-card--question">

        <header class="pt-question-header">
          <span class="pt-question-index">
            Question {{ forloop.counter }}
          </span>
        </header>

        <p class="pt-question-text">
          {{ question.stem }}
        </p>

        {% if question.choices.all %}
        <div class="pt-choices">
          {% for choice in question.choices.all %}
          <label class="pt-choice">
            <input
              type="radio"
              name="q{{ question.id }}"
              value="{{ choice.id }}"
              required
            >
            <span>{{ choice.text }}</span>
          </label>
          {% endfor %}
        </div>
        {% endif %}

      </article>
      {% endfor %}

      <!-- CTA -->
      <div class="pt-cta-group center">
        <button type="submit" class="pt-btn-primary pt-btn-lg">
          âœ… Terminer lâ€™examen
        </button>
      </div>

    </form>
    {% else %}
      <p class="pt-empty text-center">
        Aucune question disponible pour cette session.
      </p>
    {% endif %}

  </div>
</section>

{% endblock %}
