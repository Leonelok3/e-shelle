{% extends "base.html" %}
{% load static %}

{% block title %}
Reprendre mes erreurs | Immigration97
{% endblock %}

{% block meta_description %}
Rejoue uniquement les questions que tu as rat√©es pour progresser plus vite
gr√¢ce au mode de correction cibl√©e Immigration97.
{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="{% static 'css/pages/preparation_tests.css' %}">
{% endblock %}

{% block content %}

<section class="page page-retry-errors">

  <!-- ===== TOP BAR ===== -->
  <div class="top-bar">
    <a class="back-link"
       href="{% url 'preparation_tests:session_result' session.id %}">
      ‚Üê Retour au r√©sultat
    </a>

    <div class="chips">
      <span class="chip">Session #{{ session.id }}</span>
      <span class="chip chip-strong">Correction cibl√©e</span>
    </div>
  </div>

  <!-- ===== HERO ===== -->
  <header class="hero">
    <span class="hero-kicker">R√©vision cibl√©e</span>

    <h1 class="hero-title">
      Question {{ index|add:1 }} / {{ total }}
      ‚Äî <span>erreurs √† corriger</span>
    </h1>

    <p class="hero-sub">
      Concentre-toi uniquement sur les questions que tu as rat√©es.
      Chaque bonne r√©ponse ici acc√©l√®re ta progression. üí™
    </p>
  </header>

  <!-- ===== PROGRESSION ===== -->
  <div class="progress-wrap">
    <div class="progress-label">
      <span>Progression</span>
      <span>{{ index|add:1 }} / {{ total }}</span>
    </div>

    {% widthratio index|add:1 total 100 as pct %}
    <div class="progress-outer">
      <div class="progress-inner" style="width: {{ pct }}%;"></div>
    </div>
  </div>

  <!-- ===== QUESTION ===== -->
  <article class="card">

    <header class="card-header">
      <span class="badge-section">
        Question #{{ question.id }}
      </span>
      <span class="badge-mode">
        Mode : reprise des erreurs
      </span>
    </header>

    <div class="question-text">
      {{ question.stem|linebreaksbr }}
    </div>

    {% if choices %}
    <form method="post">
      {% csrf_token %}

      <div class="choices">
        {% for choice in choices %}
        <label class="choice-item">
          <input type="radio" name="choice" value="{{ choice.id }}" required>
          <div class="choice-text">
            {{ choice.text }}
          </div>
        </label>
        {% endfor %}
      </div>

      <footer class="card-footer">
        <p class="hint">
          S√©lectionne ta r√©ponse puis clique sur
          <strong>Valider</strong>.
        </p>

        <button type="submit" class="btn btn--primary">
          Valider et continuer ‚Üí
        </button>
      </footer>
    </form>
    {% else %}
      <p class="muted">
        Aucune proposition trouv√©e pour cette question.
      </p>
    {% endif %}

  </article>

</section>

{% endblock %}
