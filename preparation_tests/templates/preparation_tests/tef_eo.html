{% extends "base.html" %}
{% load static %}

{% block title %}
TEF â€” Expression Orale (EO) | Immigration97
{% endblock %}

{% block meta_description %}
EntraÃ®nement TEF Expression Orale : simulation dâ€™entretien, enregistrement,
transcription et analyse automatique.
{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="{% static 'css/pages/tef_eo.css' %}">
{% endblock %}

{% block content %}

<section class="page page-tef-eo">

  <!-- ===== HERO ===== -->
  <section class="hero">
    <article class="hero-card">
      <div class="hero-top">
        <div>
          <div class="hero-badge">TEF â€¢ EXPRESSION ORALE</div>
          <h1 class="hero-title">
            Cours â€” <span class="accent">Expression Orale (EO)</span>
          </h1>
          <p class="small">
            EntraÃ®ne-toi dans des conditions rÃ©elles :
            sujets officiels, relances, enregistrement et analyse dÃ©taillÃ©e.
          </p>
        </div>

        <div class="hero-actions">
          <a class="btn btn-primary" href="{% url 'preparation_tests:start_session' 'tef' %}?section=eo">
            ğŸ¤ DÃ©marrer une session EO
          </a>
          <a class="btn btn-soft" href="{% url 'preparation_tests:exam_detail' 'tef' %}#oral">
            ğŸ“„ Format officiel TEF
          </a>
        </div>
      </div>
    </article>
  </section>

  <!-- ===== NAV COURS ===== -->
  <div class="quick-nav no-print">
    <a class="btn btn-ghost btn-sm" href="{% url 'preparation_tests:tef_co' %}">ğŸ§ CO</a>
    <a class="btn btn-ghost btn-sm" href="{% url 'preparation_tests:tef_ce' %}">ğŸ“– CE</a>
    <a class="btn btn-ghost btn-sm" href="{% url 'preparation_tests:tef_ee' %}">âœï¸ EE</a>
    <a class="btn btn-ghost btn-sm active">ğŸ¤ EO</a>
  </div>

  <!-- ===== LAYOUT ===== -->
  <section class="eo-layout">

    <!-- ===== LEÃ‡ONS ===== -->
    <div class="eo-lessons">

      <h2 class="section-title">ğŸ“š Cours complets â€” Expression Orale</h2>
      <p class="section-subtitle">
        Travaille la structure O.R.E.C., les relances et lâ€™interaction naturelle.
      </p>

      {% if lessons %}
        {% for l in lessons %}
          <article class="lesson-card">
            <header class="lesson-header">
              <h3>{{ l.title }}</h3>
              <span class="lesson-meta">
                Mise Ã  jour : {{ l.updated_at|date:"d/m/Y" }}
              </span>
            </header>

            <div class="lesson-body">
              {{ l.content_html|safe }}

              <div class="lesson-actions">
                <a href="{% url 'preparation_tests:lesson_session_eo' l.id %}"
                   class="btn btn-primary">
                  ğŸš€ Exercices EO
                </a>
              </div>
            </div>
          </article>
        {% endfor %}
      {% else %}
        <article class="lesson-card">
          <h3>LeÃ§ons EO Ã  venir</h3>
          <p class="small">
            Des modÃ¨les complets EO seront ajoutÃ©s trÃ¨s prochainement.
          </p>
        </article>
      {% endif %}

    </div>

    <!-- ===== SIMULATEUR + ANALYSE ===== -->
    <aside class="eo-side">

      <!-- SIMULATION -->
      <section class="card simulator">
        <h3>ğŸ¬ Simulation dâ€™entretien</h3>
        <p class="small">
          Choisis un sujet, parle 2â€“3 minutes et enregistre-toi.
        </p>

        <div id="eo-topic" class="topic-box">
          Clique sur Â« Nouveau sujet Â» pour commencer.
        </div>
        <div id="eo-relance" class="relance-box"></div>

        <div class="timer" id="eo-timer">00:00</div>

        <div class="btn-group">
          <button class="btn btn-primary" id="eo-new-topic">ğŸ¯ Nouveau sujet</button>
          <button class="btn" id="eo-start">ğŸ™ï¸ Enregistrer</button>
          <button class="btn" id="eo-stop">â¹ï¸ Stop</button>
        </div>

        <div id="eo-audio"></div>
      </section>

      <!-- ANALYSE -->
      <section class="card analysis">
        <h3>ğŸ”¬ Analyse & feedback</h3>

        <textarea id="eo-transcript" class="textarea"
          placeholder="Transcription automatique ou manuelleâ€¦"></textarea>

        <div class="btn-group">
          <button class="btn btn-primary" id="eo-analyze">ğŸ” Analyser</button>
          <button class="btn" id="eo-export">ğŸ“„ Export PDF</button>
        </div>

        <div class="metrics">
          <span id="eo-wpm">â€”</span>
          <span id="eo-ttr">â€”</span>
          <span id="eo-connectors">â€”</span>
          <span id="eo-score">â€”</span>
        </div>

        <div id="eo-tips" class="tips"></div>
      </section>

    </aside>
  </section>

  <div class="footer-nav no-print">
    <a class="btn btn-soft" href="{% url 'preparation_tests:tef_hub' %}">
      â¬… Retour menu TEF
    </a>
  </div>

</section>

{% endblock %}

{% block scripts_extra %}
<script src="{% static 'js/tef_eo.js' %}"></script>
{% endblock %}
