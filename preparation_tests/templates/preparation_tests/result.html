{% extends "base.html" %}
{% load static %}

{% block title %}R√©sultat ‚Äî Pr√©paration Tests de Langue | Immigration97{% endblock %}
{% block meta %}
<meta name="description" content="Score global et d√©tail par section : compr√©hension orale/√©crite, expression √©crite/orale. Recommencez et progressez.">
<link rel="canonical" href="/prep/session/{{ session.id }}/result/">
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'preparation_tests/styles.css' %}">
{% endblock %}

{% block content %}
<section class="container py-5">
  <header class="mb-4">
    <h1 class="h4 mb-2">‚úÖ R√©sultat de la session</h1>
    <p class="text-secondary mb-0">
      Examen : <strong>{{ session.exam.name }}</strong> ‚Ä¢ Mode : {{ session.mode }}<br>
      D√©marr√©e : {{ session.started_at|date:"d/m/Y H:i" }}{% if session.completed_at %} ‚Ä¢ Termin√©e : {{ session.completed_at|date:"d/m/Y H:i" }}{% endif %}
    </p>
  </header>

  <article class="card-soft mb-4">
    <div class="card-body d-flex align-items-center justify-content-between">
      <div>
        <div class="text-secondary small">Score total</div>
        <div class="display-6">{{ total_correct }} / {{ total_items }}</div>
      </div>
      <div>
        <a href="{% url 'preparation_tests:exam_list' %}" class="btn btn-outline-secondary btn-pill me-2">‚¨Ö Choisir un autre examen</a>
        <a href="/" class="btn btn-primary btn-pill">Accueil</a>
      </div>
    </div>
  </article>

  <h2 class="h6 mb-3">D√©tail par section</h2>
  {% if attempts %}
    <ul class="list-group mb-4">
      {% for a in attempts %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <span>
            {% if a.section.code == 'listening' %}üéß{% elif a.section.code == 'reading' %}üìñ{% elif a.section.code == 'writing' %}‚úçÔ∏è{% else %}üó£Ô∏è{% endif %}
            {{ a.section.get_code_display }}
          </span>
          <span class="badge bg-primary rounded-pill">{{ a.raw_score|floatformat:0 }} / {{ a.total_items }}</span>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <div class="alert alert-info">Aucune tentative enregistr√©e.</div>
  {% endif %}

  <div class="d-flex flex-wrap gap-2">
    <a href="{% url 'preparation_tests:exam_list' %}" class="btn btn-outline-secondary btn-pill">Refaire un examen</a>
    <a href="/visa-photo/" class="btn btn-outline-primary btn-pill">D√©couvrir Visa Photo</a>
    <a href="/cv-generator/" class="btn btn-outline-primary btn-pill">Cr√©er un CV</a>
    <a href="/motivation/" class="btn btn-outline-primary btn-pill">Lettre de motivation</a>
  </div>
</section>
{% endblock %}
