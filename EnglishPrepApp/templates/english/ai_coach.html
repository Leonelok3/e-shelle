{% extends "base.html" %}
{% load static %}

{% block title %}
Coach IA ‚Äì Pr√©paration anglais Immigration97
{% endblock %}

{% block meta %}
<meta name="description" content="Coach IA d'anglais connect√© √† ton niveau, ton historique de tests et tes objectifs (immigration, √©tudes, travail). Pr√©pare l‚ÄôIELTS, le TOEFL et le TOEIC avec un accompagnement intelligent.">
<meta name="keywords" content="coach IA anglais, IELTS, TOEFL, TOEIC, test anglais, Immigration97">
<meta property="og:title" content="Coach IA ‚Äì Pr√©paration anglais Immigration97">
<meta property="og:description" content="Un coach d'anglais intelligent, connect√© √† ton profil, pour progresser efficacement.">
<meta property="og:type" content="website">
{% endblock %}

{% block content %}
<main class="min-h-screen bg-slate-950 text-slate-50">

  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8 lg:py-12">

    <!-- NAVIGATION -->
    <nav class="mb-6 border-b border-slate-800 pb-4">
      <div class="flex flex-wrap justify-end gap-2 text-[11px]">
        <a href="{% url 'englishprep:dashboard' %}" class="rounded-full border border-slate-700 bg-slate-900 px-3 py-1 text-slate-200 hover:bg-slate-800 transition">
          üè† Tableau de bord
        </a>
        <a href="{% url 'englishprep:exam_hub' %}" class="rounded-full border border-slate-700 bg-slate-900 px-3 py-1 text-slate-200 hover:bg-slate-800 transition">
          üåê Hub IELTS / TOEFL / TOEIC
        </a>
        <a href="{% url 'englishprep:exam_list' %}" class="rounded-full border border-slate-700 bg-slate-900 px-3 py-1 text-slate-200 hover:bg-slate-800 transition">
          üìö Tous les tests
        </a>
        <a href="{% url 'englishprep:test_history' %}" class="rounded-full border border-slate-700 bg-slate-900 px-3 py-1 text-slate-200 hover:bg-slate-800 transition">
          üìã Historique
        </a>
      </div>
    </nav>

    <!-- HERO -->
    <section class="mb-10 max-w-3xl">
      <span class="inline-block rounded-full border border-emerald-500/40 bg-emerald-500/10 px-3 py-1 text-[10px] font-semibold uppercase tracking-widest text-emerald-300">
        Coach IA Anglais
      </span>

      <h1 class="mt-4 text-3xl md:text-4xl font-light tracking-tight">
        <span class="bg-gradient-to-r from-slate-50 via-blue-100 to-emerald-200 bg-clip-text text-transparent">
          Ton coach IA pour r√©ussir les tests d‚Äôanglais
        </span>
      </h1>

      <p class="mt-3 text-sm md:text-base text-slate-300">
        Pose tes questions sur l‚ÄôIELTS, le TOEFL ou le TOEIC.  
        Le coach analyse ton niveau, tes scores et ton objectif pour te guider efficacement.
      </p>
    </section>

    {% if error %}
      <div class="mb-6 rounded-xl border border-red-500/40 bg-red-500/10 px-4 py-3 text-sm text-red-100">
        {{ error }}
      </div>
    {% endif %}

    <!-- GRID -->
    <section class="grid grid-cols-1 lg:grid-cols-12 gap-8">

      <!-- PROFIL -->
      <aside class="lg:col-span-4 space-y-4">
        {% include "english/profile_summary_block.html" ignore missing %}
      </aside>

      <!-- COACH -->
      <section class="lg:col-span-8 space-y-6">

        <article class="rounded-3xl border border-slate-700 bg-slate-900 p-6">
          <form method="post" class="space-y-4">
            {% csrf_token %}

            <label class="block text-sm font-medium text-slate-200">
              Pose ta question au coach IA
            </label>

            <textarea
              name="question"
              rows="4"
              data-preset="{{ preset|default:''|escapejs }}"
              class="w-full rounded-2xl border border-slate-700 bg-slate-950 px-4 py-3 text-sm text-slate-100 placeholder:text-slate-500 focus:ring-2 focus:ring-emerald-500/70"
              placeholder="Ex : Comment am√©liorer mon listening IELTS en 30 jours ?"
            ></textarea>

            <button type="submit"
              class="inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-emerald-400 to-blue-500 px-6 py-3 text-sm font-bold text-slate-950 hover:opacity-90 transition">
              ü§ñ Lancer le coach IA
            </button>
          </form>

          {% if ai_answer %}
          <div class="mt-8 rounded-2xl border border-emerald-500/40 bg-emerald-500/5 p-5 text-sm">
            <p class="mb-3 text-[11px] font-bold uppercase tracking-widest text-emerald-300">
              R√©ponse du coach IA
            </p>
            <div class="prose prose-invert max-w-none">
              {{ ai_answer|linebreaksbr }}
            </div>
          </div>
          {% endif %}
        </article>

        <!-- EXEMPLES -->
        <article class="rounded-2xl border border-slate-800 bg-slate-900 p-5 text-xs text-slate-300">
          <p class="mb-2 text-[11px] font-semibold uppercase tracking-widest text-slate-400">
            Exemples de questions
          </p>
          <ul class="space-y-1">
            <li>‚Ä¢ Plan de r√©vision IELTS B2 en 4 semaines</li>
            <li>‚Ä¢ Diff√©rence entre present perfect et past simple</li>
            <li>‚Ä¢ Exercices de vocabulaire TOEIC niveau interm√©diaire</li>
          </ul>
        </article>

      </section>
    </section>
  </div>

  <!-- JS externe -->
  <script src="{% static 'js/pages/ai_coach.js' %}"></script>
</main>
{% endblock %}
