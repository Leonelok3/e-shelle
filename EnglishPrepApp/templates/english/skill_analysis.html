{% extends "base.html" %}

{% block title %}
Analyse de tes compÃ©tences en anglais â€“ Immigration97
{% endblock %}

{% block meta %}
<meta name="description" content="Analyse dÃ©taillÃ©e de tes compÃ©tences en anglais aprÃ¨s ton test sur Immigration97.">
{% endblock %}

{% block content %}
<main class="relative min-h-screen overflow-hidden bg-slate-950 text-slate-50">

  <!-- ğŸŒˆ BACKGROUND -->
  <div class="pointer-events-none absolute inset-0 -z-10 overflow-hidden">
    <div class="absolute -top-40 -left-32 h-72 w-72 rounded-full bg-gradient-to-br from-blue-500/25 via-emerald-400/10 to-transparent blur-3xl opacity-60"></div>
    <div class="absolute top-1/3 -right-32 h-80 w-80 rounded-full bg-gradient-to-br from-emerald-500/20 via-blue-500/15 to-transparent blur-3xl opacity-60"></div>
    <div class="absolute bottom-0 left-1/2 h-72 w-[420px] -translate-x-1/2 translate-y-1/3 rounded-full bg-gradient-to-t from-amber-500/20 via-emerald-500/10 to-transparent blur-3xl opacity-60"></div>
  </div>

  <div class="relative z-10 mx-auto max-w-7xl px-4 py-10 sm:px-6 lg:py-16">

    <!-- NAV -->
    <nav class="mb-8 flex flex-wrap gap-2 text-[0.7rem]">
      <a href="{% url 'englishprep:dashboard' %}" class="rounded-3xl border border-slate-700/80 bg-slate-900/80 px-3 py-1.5 text-slate-200 hover:bg-slate-800/80">ğŸ  Tableau de bord</a>
      <a href="{% url 'englishprep:exam_hub' %}" class="rounded-3xl border border-slate-700/80 bg-slate-900/80 px-3 py-1.5 text-slate-200 hover:bg-slate-800/80">ğŸŒ Hub examens</a>
      <a href="{% url 'englishprep:exam_list' %}" class="rounded-3xl border border-slate-700/80 bg-slate-900/80 px-3 py-1.5 text-slate-200 hover:bg-slate-800/80">ğŸ“š Tous les tests</a>
      <a href="{% url 'englishprep:test_history' %}" class="rounded-3xl border border-slate-700/80 bg-slate-900/80 px-3 py-1.5 text-slate-200 hover:bg-slate-800/80">ğŸ“‹ Historique</a>
    </nav>

    <!-- HERO -->
    <section class="mb-10 border-b border-slate-800/60 pb-8">
      <p class="text-[0.7rem] uppercase tracking-[0.2em] text-slate-400">
        Immigration97 â€¢ Analyse des compÃ©tences
      </p>

      <h1 class="mt-3 bg-gradient-to-r from-emerald-300 via-blue-300 to-sky-400 bg-clip-text text-3xl font-light text-transparent sm:text-4xl">
        Analyse de tes compÃ©tences
        <span class="block text-slate-50/90">{{ session.test.name }}</span>
      </h1>

      <p class="mt-4 max-w-2xl text-sm text-slate-300">
        DÃ©composition dÃ©taillÃ©e de ton test par compÃ©tence pour identifier prÃ©cisÃ©ment
        les points forts et les axes dâ€™amÃ©lioration.
      </p>

      <div class="mt-4 flex flex-wrap gap-2 text-[0.75rem]">
        <span class="rounded-full bg-slate-800/80 px-3 py-1 text-slate-200">
          Score global : <strong class="text-emerald-300">{{ session.score|default:"0.0" }}%</strong>
        </span>
        <span class="rounded-full bg-slate-800/80 px-3 py-1 text-slate-200">
          {{ session.test.get_exam_type_display }} â€¢ Niveau {{ session.test.level }}
        </span>
        <span class="rounded-full bg-slate-800/80 px-3 py-1 text-slate-200">
          {{ session.started_at|date:"d/m/Y Ã  H:i" }}
        </span>
      </div>
    </section>

    <!-- GRID -->
    <section class="grid gap-6 lg:grid-cols-3">

      <!-- LEFT -->
      <div class="space-y-5 lg:col-span-1">

        {% with reading=skill_stats.READING grammar=skill_stats.USE_OF_ENGLISH %}

        <article class="rounded-2xl border border-slate-800/80 bg-slate-900/80 p-5">
          <h2 class="text-sm font-semibold text-slate-100">Reading comprehension</h2>
          <p class="mt-1 text-xs text-slate-400">
            ComprÃ©hension de textes et repÃ©rage dâ€™informations.
          </p>
          <p class="mt-3 text-2xl font-semibold text-blue-300">
            {{ reading.pct|default:"0"|floatformat:0 }}%
          </p>
        </article>

        <article class="rounded-2xl border border-slate-800/80 bg-slate-900/80 p-5">
          <h2 class="text-sm font-semibold text-slate-100">Grammaire & vocabulaire</h2>
          <p class="mt-1 text-xs text-slate-400">
            Structures, temps verbaux et vocabulaire.
          </p>
          <p class="mt-3 text-2xl font-semibold text-emerald-300">
            {{ grammar.pct|default:"0"|floatformat:0 }}%
          </p>
        </article>

        {% endwith %}

        <article class="rounded-2xl border border-emerald-500/40 bg-emerald-500/10 p-5">
          <h2 class="text-sm font-semibold text-emerald-200">
            Prochaine Ã©tape
          </h2>
          <div class="mt-4 flex flex-col gap-2 text-sm">
            <a href="{% url 'englishprep:exam_list' %}"
               class="rounded-3xl bg-gradient-to-r from-emerald-400 to-blue-500 px-4 py-2 text-center font-semibold text-slate-950">
              ğŸš€ Nouvel examen
            </a>
            <a href="{% url 'englishprep:test_result' session.test.id %}"
               class="rounded-3xl border border-slate-700 bg-slate-900/70 px-4 py-2 text-center text-slate-200">
              ğŸ“Š RÃ©sultat du test
            </a>
          </div>
        </article>

      </div>

      <!-- RIGHT -->
      <div class="lg:col-span-2">
        <article class="rounded-2xl border border-slate-800/80 bg-slate-900/80 p-6">
          <h2 class="mb-4 text-sm font-semibold uppercase tracking-[0.18em] text-slate-400">
            RÃ©partition par compÃ©tence
          </h2>

          <div class="space-y-4 text-sm">
            {% for key, data in skill_stats.items %}
              <div class="flex items-center justify-between rounded-xl border border-slate-800/70 bg-slate-950/60 px-4 py-3">
                <span class="text-slate-200">{{ key }}</span>
                <span class="font-semibold text-emerald-300">
                  {{ data.pct|default:"0"|floatformat:0 }}%
                </span>
              </div>
            {% endfor %}
          </div>
        </article>
      </div>

    </section>

  </div>
</main>
{% endblock %}
