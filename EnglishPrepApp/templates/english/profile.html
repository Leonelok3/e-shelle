{% extends "base.html" %}
{% load static %}

{% block title %}Profil Anglais ‚Äì XP, Niveau & Tests | Immigration97{% endblock %}

{% block meta %}
<meta name="description" content="Visualise ta progression en anglais sur Immigration97 : XP, niveau, badges, historique des tests et recommandations personnalis√©es.">
<meta property="og:title" content="Profil anglais ‚Äì Immigration97">
<meta property="og:description" content="XP, niveau, badges et suivi de tes tests d‚Äôanglais (IELTS, TOEFL, TOEIC).">
<meta property="og:type" content="website">
{% endblock %}

{% block content %}
<main class="relative min-h-screen overflow-hidden bg-slate-950 text-slate-50">

  <!-- Background -->
  <div class="absolute inset-0 -z-10 pointer-events-none overflow-hidden">
    <div class="absolute top-0 left-1/2 w-[600px] h-[600px] -translate-x-1/2 bg-gradient-to-br from-blue-500/20 via-emerald-400/10 to-transparent blur-3xl"></div>
    <div class="absolute bottom-0 right-0 w-[500px] h-[500px] bg-gradient-to-tl from-emerald-500/20 via-blue-500/15 to-transparent blur-3xl"></div>
  </div>

  <div class="relative z-10 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10 lg:py-14">

    <!-- HEADER -->
    <header class="mb-10">
      <h1 class="text-3xl md:text-4xl lg:text-5xl font-light tracking-tight bg-gradient-to-r from-emerald-300 via-blue-300 to-sky-400 bg-clip-text text-transparent">
        Mon profil anglais üá¨üáß
      </h1>
      <p class="mt-3 text-slate-300 max-w-2xl text-sm md:text-base">
        Suivi de ta progression : XP, niveau, badges, tests pass√©s et recommandations intelligentes.
      </p>
    </header>

    {% if not profile %}
      <div class="rounded-xl border border-slate-700/70 bg-slate-900/80 p-6 text-center">
        <p class="text-slate-300 text-sm">
          Aucun profil trouv√©. Passe un test d‚Äôanglais pour commencer.
        </p>
      </div>
    {% else %}

    <!-- GRID -->
    <section class="grid grid-cols-1 lg:grid-cols-3 gap-8">

      <!-- PROFIL -->
      <div class="lg:col-span-1 space-y-6">

        <article class="rounded-2xl border border-slate-700/60 bg-slate-900/70 p-6 backdrop-blur-xl">
          <h2 class="text-xs font-bold tracking-[0.18em] uppercase text-slate-400 mb-4">
            Ton profil
          </h2>

          <div class="grid grid-cols-2 gap-4 text-xs">
            <div>
              <p class="text-slate-500 text-[11px]">Niveau</p>
              <p class="text-3xl font-bold text-blue-400">{{ profile.level }}</p>
            </div>
            <div>
              <p class="text-slate-500 text-[11px]">XP totale</p>
              <p class="text-2xl font-semibold text-emerald-300">{{ profile.xp }}</p>
            </div>
            <div>
              <p class="text-slate-500 text-[11px]">Meilleur score</p>
              <p class="text-xl font-semibold">{{ profile.best_score }}%</p>
            </div>
            <div>
              <p class="text-slate-500 text-[11px]">Tests pass√©s</p>
              <p class="text-xl font-semibold">{{ profile.total_tests }}</p>
            </div>
          </div>

          {% if profile.badges %}
            <p class="mt-6 text-xs font-semibold text-slate-400 uppercase">
              Badges obtenus
            </p>
            <div class="mt-2 flex flex-wrap gap-2">
              {% for badge in profile.badges %}
                <span class="px-3 py-1 rounded-full bg-emerald-500/10 border border-emerald-400/30 text-[11px] text-emerald-200">
                  üèÖ {{ badge }}
                </span>
              {% endfor %}
            </div>
          {% endif %}
        </article>

        <article class="rounded-2xl border border-emerald-500/40 bg-emerald-500/10 p-6">
          <h3 class="text-xs font-bold tracking-[0.18em] uppercase text-emerald-300">
            Coach IA
          </h3>
          <p class="text-sm text-emerald-100 mt-2 mb-4">
            Analyse intelligente de ton profil et recommandations personnalis√©es.
          </p>
          <a href="{% url 'englishprep:ai_coach' %}?preset=Analyse+mon+profil+anglais"
             class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-gradient-to-r from-emerald-400 to-blue-500 text-slate-950 text-xs font-bold">
            ü§ñ Analyser mon profil
          </a>
        </article>

      </div>

      <!-- CONTENU -->
      <div class="lg:col-span-2 space-y-10">

        <article class="rounded-2xl border border-slate-700/60 bg-slate-900/70 p-6">
          <h2 class="text-xs font-bold tracking-[0.18em] uppercase text-slate-400 mb-4">
            Progression XP
          </h2>

          <div class="h-3 w-full rounded-full bg-slate-800 overflow-hidden">
            <div class="h-full bg-gradient-to-r from-emerald-400 via-blue-500 to-sky-400"
                 style="width: {{ xp_pct }}%;"></div>
          </div>

          <p class="mt-2 text-xs text-slate-400">
            {{ xp_in_level }} / {{ xp_needed }} XP ‚Äì Niveau {{ profile.level }}
          </p>
        </article>

      </div>
    </section>
    {% endif %}
  </div>
</main>
{% endblock %}
