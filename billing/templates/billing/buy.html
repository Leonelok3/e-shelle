{# billing/templates/billing/buy.html #}
{% extends 'base.html' %}
{% load static %}

{% block title %}Acheter Code d'Acc√®s Premium Immigration Canada - Visa & R√©sidence Permanente | Immigration97{% endblock %}

{% block meta_description %}Obtenez votre code d'activation Immigration97 instantan√©. Acc√®s 24h ou 30 jours aux outils premium : visa Canada, r√©sidence permanente, tests IELTS TCF TEF, CV international. Paiement s√©curis√© Mobile Money Afrique (Orange, MTN, Moov) et PayPal international.{% endblock %}

{% block body_class %}billing{% endblock %}
{% block app_scope %}billing{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/billing.css' %}">
{% endblock %}

{% block content %}
<!-- Schema.org pour SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Product",
  "name": "Code d'Acc√®s Premium Immigration97",
  "description": "Code d'activation pour acc√©der aux outils premium d'immigration Canada, r√©sidence permanente, tests de langue et CV international",
  "brand": {
    "@type": "Organization",
    "name": "Immigration97"
  },
  "offers": {
    "@type": "AggregateOffer",
    "priceCurrency": "USD",
    "lowPrice": "{% if plans and plans|length > 0 %}{{ plans.0.price_usd }}{% else %}0{% endif %}",
    "highPrice": "{% if plans and plans|length > 0 %}{{ plans|last.price_usd }}{% else %}0{% endif %}",
    "offerCount": "{{ plans|length }}"
  }
}
</script>

<div class="buycode-container">
    <!-- HEADER SECTION -->
    <header class="buycode-header">
        <div class="header-badge">üéüÔ∏è Codes d'activation instantan√©s</div>
        <h1 class="buycode-title">Obtenez votre Code d'Acc√®s Premium</h1>
        <p class="buycode-subtitle">
            D√©bloquez instantan√©ment tous les outils premium d'immigration Canada : visa travail, r√©sidence permanente, tests IELTS/TCF/TEF, CV international ATS-optimis√© et guides officiels IRCC 2026.
        </p>

        <!-- AVANTAGES RAPIDES -->
        <div class="quick-benefits">
            <div class="benefit-item">
                <span class="benefit-icon">‚ö°</span>
                <span>Activation imm√©diate</span>
            </div>
            <div class="benefit-item">
                <span class="benefit-icon">üîí</span>
                <span>Paiement 100% s√©curis√©</span>
            </div>
            <div class="benefit-item">
                <span class="benefit-icon">üåç</span>
                <span>Mobile Money Afrique</span>
            </div>
            <div class="benefit-item">
                <span class="benefit-icon">üí≥</span>
                <span>PayPal International</span>
            </div>
        </div>
    </header>

    <!-- PLANS GRID -->
    <div class="buycode-plans-grid">
        {% for p in plans %}
        <article class="buycode-plan {% if p.duration_days > 1 %}plan-featured{% endif %}"
                 itemscope itemtype="https://schema.org/Offer">

            {% if p.duration_days > 1 %}
            <div class="featured-badge">üèÜ Recommand√©</div>
            {% elif p.duration_days == 1 %}
            <div class="featured-badge featured-badge--trial">‚ö° Essai</div>
            {% endif %}

            <div class="plan-header">
                <h2 class="plan-name" itemprop="name">{{ p.name }}</h2>
                <p class="plan-description">
                    {% if p.duration_days == 1 %}
                    Parfait pour tester nos outils premium pendant 24 heures
                    {% else %}
                    Acc√®s complet √† tous les outils premium d'immigration
                    {% endif %}
                </p>
            </div>

            <!-- PRIX -->
            <div class="plan-price-box">
                <div class="price-main">
                    <span class="price-currency" itemprop="priceCurrency" content="USD">$</span>
                    <span class="price-amount" itemprop="price" content="{{ p.price_usd }}">{{ p.price_usd }}</span>
                    <span class="price-unit">USD</span>
                </div>

                <div class="price-local">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 6v6l4 2"></path>
                    </svg>
                    Environ {{ p.price_xaf|floatformat:0 }} FCFA
                </div>

                <div class="duration-badge">
                    ‚è±Ô∏è {{ p.duration_days }} jour{% if p.duration_days > 1 %}s{% endif %} d'acc√®s illimit√©
                </div>
            </div>

            <!-- FEATURES INCLUSES -->
            <div class="plan-features-mini">
                <h3 class="features-mini-title">‚úÖ Acc√®s inclus :</h3>
                <ul class="features-mini-list">
                    <li>G√©n√©rateur CV International</li>
                    <li>Photo Visa Biom√©trique</li>
                    <li>Tests IELTS, TCF, TEF</li>
                    <li>Guides Visa & RP Canada</li>
                    <li>Calculateurs Immigration</li>
                    {% if p.duration_days > 1 %}
                    <li>Support prioritaire 24/7</li>
                    <li>Suivi dossier personnel</li>
                    {% endif %}
                </ul>
            </div>

            <!-- FORMULAIRE PAIEMENT -->
            <form method="post" action="{% url 'billing:buy' %}" class="buycode-form">
                {% csrf_token %}
                <input type="hidden" name="plan_id" value="{{ p.id }}">
                <input type="hidden" name="next" value="{{ next|default:'' }}">

                <div class="payment-buttons">
                    <p class="payment-label">Choisissez votre mode de paiement :</p>

                    <button type="submit" name="source" value="chario"
                            class="btn-payment btn-payment--primary">
                        <span class="btn-icon">üì±</span>
                        <span class="btn-text">
                            <strong>Mobile Money Afrique</strong>
                            <small>Orange, MTN, Moov, Wave</small>
                        </span>
                    </button>

                    <button type="submit" name="source" value="orange_money"
                            class="btn-payment btn-payment--orange">
                        <span class="btn-icon">
                            <img src="{% static 'img/om-logo.png' %}" alt="Orange Money" width="24" height="24">
                        </span>
                        <span class="btn-text">
                            <strong>Orange Money</strong>
                            <small>Cameroun, CI, S√©n√©gal</small>
                        </span>
                    </button>

                    <button type="submit" name="source" value="paypal"
                            class="btn-payment btn-payment--paypal">
                        <span class="btn-icon">üí≥</span>
                        <span class="btn-text">
                            <strong>PayPal</strong>
                            <small>Carte bancaire internationale</small>
                        </span>
                    </button>
                </div>
            </form>

            <!-- TAGS SEO -->
            <div class="plan-tags">
                <span class="tag">#VisaCanada</span>
                <span class="tag">#R√©sidencePermanente</span>
                <span class="tag">#IELTS</span>
                <span class="tag">#TCF</span>
                <span class="tag">#CVInternational</span>
                {% if p.duration_days > 1 %}
                <span class="tag">#Entr√©eExpress</span>
                <span class="tag">#PNP</span>
                {% endif %}
            </div>
        </article>
        {% empty %}
        <div class="empty-state">
            <div class="empty-icon">‚ö†Ô∏è</div>
            <h3 class="empty-title">Aucun plan disponible</h3>
            <p class="empty-text">
                Les codes d'activation sont temporairement indisponibles.
                Veuillez r√©essayer dans quelques instants ou contactez notre support.
            </p>
            <a href="{% url 'billing:pricing' %}" class="btn btn-primary">
                Voir les abonnements classiques
            </a>
        </div>
        {% endfor %}
    </div>

    <!-- SECTION CONFIANCE -->
    <aside class="trust-section-buycode">
        <h3 class="trust-title">üîê Pourquoi choisir Immigration97 ?</h3>
        <div class="trust-grid-buycode">
            <div class="trust-card">
                <div class="trust-card-icon">‚ö°</div>
                <h4 class="trust-card-title">Activation Instantan√©e</h4>
                <p class="trust-card-text">
                    Recevez votre code d'activation par email dans les 2 minutes apr√®s paiement. Acc√®s imm√©diat √† tous les outils premium.
                </p>
            </div>

            <div class="trust-card">
                <div class="trust-card-icon">üîí</div>
                <h4 class="trust-card-title">Paiement 100% S√©curis√©</h4>
                <p class="trust-card-text">
                    Cryptage SSL 256-bit, certifi√© PCI-DSS. Vos donn√©es bancaires sont prot√©g√©es par les standards internationaux.
                </p>
            </div>

            <div class="trust-card">
                <div class="trust-card-icon">üì±</div>
                <h4 class="trust-card-title">Mobile Money Afrique</h4>
                <p class="trust-card-text">
                    Payez facilement depuis votre t√©l√©phone avec Orange Money, MTN, Moov Money, Wave ou Airtel Money.
                </p>
            </div>

            <div class="trust-card">
                <div class="trust-card-icon">üåç</div>
                <h4 class="trust-card-title">PayPal International</h4>
                <p class="trust-card-text">
                    Acceptons Visa, Mastercard, American Express via PayPal. Disponible partout dans le monde.
                </p>
            </div>

            <div class="trust-card">
                <div class="trust-card-icon">üíØ</div>
                <h4 class="trust-card-title">Satisfait ou Rembours√©</h4>
                <p class="trust-card-text">
                    Garantie 30 jours. Si nos outils ne vous conviennent pas, nous vous remboursons int√©gralement.
                </p>
            </div>

            <div class="trust-card">
                <div class="trust-card-icon">üí¨</div>
                <h4 class="trust-card-title">Support 24/7</h4>
                <p class="trust-card-text">
                    √âquipe francophone disponible par email, chat et WhatsApp pour vous accompagner dans votre projet d'immigration.
                </p>
            </div>
        </div>
    </aside>

    <!-- SECTION PROCESSUS -->
    <section class="process-section">
        <h3 class="process-title">üìã Comment √ßa marche ?</h3>
        <div class="process-steps">
            <div class="process-step">
                <div class="step-number">1</div>
                <h4 class="step-title">Choisissez votre plan</h4>
                <p class="step-text">
                    S√©lectionnez la dur√©e qui correspond √† votre projet : 24h pour tester ou 30 jours pour un acc√®s complet.
                </p>
            </div>

            <div class="process-step">
                <div class="step-number">2</div>
                <h4 class="step-title">Payez en toute s√©curit√©</h4>
                <p class="step-text">
                    Choisissez Mobile Money (Afrique) ou PayPal (international). Paiement crypt√© SSL.
                </p>
            </div>

            <div class="process-step">
                <div class="step-number">3</div>
                <h4 class="step-title">Recevez votre code</h4>
                <p class="step-text">
                    Code d'activation envoy√© par email dans les 2 minutes. V√©rifiez aussi vos spams.
                </p>
            </div>

            <div class="process-step">
                <div class="step-number">4</div>
                <h4 class="step-title">Activez et profitez</h4>
                <p class="step-text">
                    Entrez votre code dans "Mon espace" et acc√©dez instantan√©ment √† tous les outils premium d'immigration.
                </p>
            </div>
        </div>
    </section>

    <!-- FAQ RAPIDE -->
    <section class="faq-buycode">
        <h3 class="faq-buycode-title">‚ùì Questions Fr√©quentes</h3>

        <details class="faq-buycode-item">
            <summary>Quel est le d√©lai de r√©ception du code ?</summary>
            <p>
                Votre code d'activation est envoy√© <strong>instantan√©ment par email</strong> apr√®s confirmation du paiement. Dans 99% des cas, vous le recevez en moins de 2 minutes. Pensez √† v√©rifier vos spams si vous ne le voyez pas.
            </p>
        </details>

        <details class="faq-buycode-item">
            <summary>Comment activer mon code d'acc√®s ?</summary>
            <p>
                Rendez-vous dans <a href="{% url 'billing:redeem' %}?next={{ next|urlencode }}">Mon espace ‚Üí Activer un code</a>, collez votre code re√ßu par email et cliquez sur "Activer".
            </p>
        </details>

        <details class="faq-buycode-item">
            <summary>Puis-je payer avec Orange Money depuis le Cameroun ?</summary>
            <p>
                Oui. Nous acceptons Orange Money (Cameroun, C√¥te d'Ivoire, S√©n√©gal, etc.) et aussi MTN, Moov, Wave.
            </p>
        </details>

        <details class="faq-buycode-item">
            <summary>Le code est-il valable pour tous les outils ?</summary>
            <p>
                Oui, votre code d'activation donne acc√®s √† <strong>100% des outils premium</strong>.
            </p>
        </details>

        <details class="faq-buycode-item">
            <summary>Puis-je prolonger mon acc√®s avant expiration ?</summary>
            <p>
                Oui ! La dur√©e s'ajoute √† votre temps restant (stacking).
            </p>
        </details>
    </section>

    <!-- CTA FINAL -->
    <div class="final-cta-buycode">
        <h3 class="cta-title">üöÄ Pr√™t √† d√©marrer votre projet d'immigration ?</h3>
        <p class="cta-text">
            Rejoignez des milliers d'africains qui ont r√©ussi leur immigration au Canada gr√¢ce √† Immigration97.
        </p>
        <a href="#" class="btn btn-primary btn-lg" onclick="window.scrollTo({top: 0, behavior: 'smooth'}); return false;">
            Choisir mon plan maintenant
        </a>
    </div>
</div>
{% endblock %}
