{# billing/templates/billing/access.html #}
{% extends "base.html" %}
{% load static %}

{% block title %}Mon AccÃ¨s Premium Immigration Canada Â· Abonnement Visa & RÃ©sidence Permanente | Immigration97{% endblock %}
{% block meta_description %}GÃ©rez votre abonnement premium Immigration97 : accÃ¨s illimitÃ© aux outils visa Canada, rÃ©sidence permanente, tests IELTS TCF TEF, CV international, photo visa biomÃ©trique. Activez votre plan dÃ¨s maintenant.{% endblock %}

{% block body_class %}billing{% endblock %}
{% block app_scope %}billing{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/billing.css' %}">
{% endblock %}

{% block content %}
<!-- Schema.org pour SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Gestion AccÃ¨s Premium Immigration Canada",
  "description": "GÃ©rez votre abonnement premium pour accÃ©der aux outils d'immigration : visa Canada, rÃ©sidence permanente, tests de langue, CV international",
  "provider": {
    "@type": "Organization",
    "name": "Immigration97",
    "url": "{{ request.scheme }}://{{ request.get_host }}"
  }
}
</script>

<div class="access-container">
    <!-- HEADER SEO -->
    <header class="access-header">
        <h1 class="access-title">Gestion de mon AccÃ¨s Premium Immigration</h1>
        <p class="access-subtitle">
            Votre abonnement pour visa Canada, rÃ©sidence permanente, tests IELTS/TCF/TEF, CV international et guides d'immigration officiels
        </p>
    </header>

    <!-- CARTE STATUT PRINCIPAL -->
    <article class="status-card">
        {% if active_subscription %}
            <div class="status-icon status-icon--active" aria-label="Abonnement actif">ğŸ›¡ï¸</div>

            <div class="status-content">
                <h2 class="status-text status-text--active">Abonnement Premium Actif</h2>

                <div class="status-details">
                    <p class="plan-name">
                        Plan <strong>{{ active_subscription.plan.name }}</strong>
                        <span class="badge badge-success">Actif</span>
                    </p>

                    <div class="access-benefits">
                        <h3 class="benefits-title">ğŸ¯ AccÃ¨s illimitÃ© Ã  :</h3>
                        <ul class="benefits-list">
                            <li>âœ… GÃ©nÃ©rateur CV International ATS-OptimisÃ©</li>
                            <li>âœ… Photo Visa BiomÃ©trique (Format officiel)</li>
                            <li>âœ… Tests de langue : IELTS, TCF, TEF</li>
                            <li>âœ… Guides Visa Travail Canada & Europe</li>
                            <li>âœ… RÃ©sidence Permanente : EntrÃ©e Express, PNP</li>
                            <li>âœ… Assistance Immigration 24/7</li>
                            <li>âœ… Calculateur Score CRS & Ã‰ligibilitÃ©</li>
                        </ul>
                    </div>
                </div>

                <div class="expiry-info">
                    <div class="expiry-date">
                        ğŸ“… Expire le : <strong>{{ active_subscription.expires_at|date:"d F Y Ã  H:i" }}</strong>
                    </div>
                    <div class="days-remaining">
                        â° <strong>{{ active_subscription.days_remaining }} jours restants</strong>
                    </div>
                    {% if active_subscription.days_remaining <= 7 %}
                    <div class="renewal-alert">
                        âš ï¸ Pensez Ã  renouveler votre abonnement pour continuer Ã  profiter des outils premium
                    </div>
                    {% endif %}
                </div>
            </div>

            <div class="status-actions">
                <a href="/" class="btn btn-primary btn-lg">
                    ğŸš€ AccÃ©der Ã  mes outils premium
                </a>
                <a href="{% url 'billing:pricing' %}" class="btn btn-secondary">
                    ğŸ”„ Renouveler mon abonnement
                </a>
            </div>

        {% elif session_active %}
            <div class="status-icon status-icon--warning" aria-label="AccÃ¨s temporaire">â±ï¸</div>

            <div class="status-content">
                <h2 class="status-text status-text--warning">AccÃ¨s Temporaire Actif</h2>
                <p class="status-description">
                    Votre session d'essai est valide. Profitez-en pour tester nos outils d'immigration premium.
                </p>

                <div class="trial-features">
                    <p class="features-intro">ğŸ AccÃ¨s temporaire Ã  :</p>
                    <ul class="benefits-list">
                        <li>GÃ©nÃ©rateur CV (limitÃ©)</li>
                        <li>Photo Visa (3 formats)</li>
                        <li>AperÃ§u tests de langue</li>
                    </ul>
                </div>
            </div>

            <div class="status-actions">
                <a href="/" class="btn btn-primary">
                    â–¶ï¸ Continuer l'exploration
                </a>
                <a href="{% url 'billing:pricing' %}" class="btn btn-secondary">
                    â­ Passer Ã  Premium
                </a>
            </div>

        {% else %}
            <div class="status-icon status-icon--inactive" aria-label="Pas d'accÃ¨s actif">ğŸ”“</div>

            <div class="status-content">
                <h2 class="status-text status-text--inactive">Aucun AccÃ¨s Actif</h2>
                <p class="status-description">
                    DÃ©bloquez tous les outils premium d'immigration Canada, visa travail, rÃ©sidence permanente, tests de langue IELTS/TCF/TEF et gÃ©nÃ©rateur CV international.
                </p>

                <div class="premium-teaser">
                    <h3 class="teaser-title">ğŸ¯ Que contient l'accÃ¨s Premium ?</h3>
                    <ul class="benefits-list">
                        <li>âœ… <strong>Visa Canada</strong> : Guide complet travail, Ã©tudes, PVT</li>
                        <li>âœ… <strong>RÃ©sidence Permanente</strong> : EntrÃ©e Express, PNP, parrainage</li>
                        <li>âœ… <strong>Tests de langue</strong> : IELTS, TCF, TEF avec exercices</li>
                        <li>âœ… <strong>CV International</strong> : Format ATS, modÃ¨les Canada/Europe</li>
                        <li>âœ… <strong>Photo Visa</strong> : BiomÃ©trique conforme normes officielles</li>
                        <li>âœ… <strong>Calculateurs</strong> : Score CRS, Ã©ligibilitÃ© immigration</li>
                        <li>âœ… <strong>Support 24/7</strong> : Assistance immigration personnalisÃ©e</li>
                    </ul>
                </div>
            </div>

            <div class="status-actions">
                <a href="{% url 'billing:pricing' %}" class="btn btn-primary btn-lg cta-pulse">
                    â­ DÃ©couvrir les Abonnements Premium
                </a>
                <a href="{% url 'billing:redeem' %}" class="btn btn-secondary">
                    ğŸŸï¸ J'ai un code d'activation
                </a>
            </div>
        {% endif %}
    </article>

    <!-- SECTION PLANS DISPONIBLES -->
    <section class="plans-section">
        <div class="plans-header">
            <h2 class="plans-title">ğŸ’ Plans d'Abonnement Premium Immigration</h2>
            <p class="plans-description">
                Choisissez le plan qui correspond Ã  votre projet d'immigration au Canada : visa travail, rÃ©sidence permanente, Ã©tudes ou PVT.
            </p>
        </div>

        <div class="plans-grid">
            {% for plan in plans %}
            <article class="mini-plan">
                <div class="plan-badge">
                    {% if plan.is_popular %}ğŸ† Populaire
                    {% elif plan.duration_days >= 365 %}ğŸ’ Annuel
                    {% elif plan.duration_days == 30 %}âš¡ Mensuel
                    {% elif plan.duration_days == 7 %}ğŸ§ª Semaine
                    {% else %}ğŸ’¼ Plan{% endif %}
                </div>

                <div class="plan-content">
                    <h3 class="plan-title">{{ plan.name }}</h3>

                    <p class="plan-meta">
                        â±ï¸ {{ plan.get_duration_display }} d'accÃ¨s complet
                    </p>

                    <div class="plan-price">
                        <span class="price-amount">{{ plan.price_xaf|floatformat:0 }} FCFA</span>
                        <span class="price-period">({{ plan.price_usd }} $)</span>
                    </div>

                    <ul class="plan-features">
                        <li>âœ… Tous les outils premium</li>
                        <li>âœ… Tests de langue illimitÃ©s</li>
                        <li>âœ… Support prioritaire</li>
                        {% if plan.duration_days >= 365 %}
                        <li>â­ Consultation gratuite</li>
                        <li>â­ Mises Ã  jour exclusives</li>
                        {% endif %}
                    </ul>
                </div>

                <div class="plan-action">
                    <a href="{% url 'billing:buy_plan' plan.slug %}" class="btn btn-primary">
                        Choisir {{ plan.name }}
                    </a>
                </div>
            </article>
            {% empty %}
            <p>Aucun plan disponible pour le moment.</p>
            {% endfor %}
        </div>
    </section>

    <!-- CTA FINAL -->
    <aside class="final-cta">
        <h3 class="cta-title">ğŸ¯ PrÃªt Ã  dÃ©marrer votre projet d'immigration ?</h3>
        <p class="cta-description">
            AccÃ¨s instantanÃ© Ã  tous les outils premium.
        </p>
        <div class="cta-buttons">
            <a href="{% url 'billing:pricing' %}" class="btn btn-primary btn-lg">
                ğŸš€ Commencer maintenant
            </a>
            {# Mets le bon lien quand ta page FAQ existe #}
            <a href="/faq/" class="btn btn-secondary">
                â“ Questions frÃ©quentes
            </a>
        </div>
    </aside>

    <!-- TRUST SECTION -->
    <aside class="trust-section">
        <div class="trust-grid">
            <div class="trust-item">
                <div class="trust-icon">ğŸ”’</div>
                <h4 class="trust-title">Paiement SÃ©curisÃ©</h4>
                <p class="trust-text">Transactions cryptÃ©es SSL</p>
            </div>
            <div class="trust-item">
                <div class="trust-icon">ğŸ’¯</div>
                <h4 class="trust-title">Satisfait ou RemboursÃ©</h4>
                <p class="trust-text">Garantie 30 jours</p>
            </div>
            <div class="trust-item">
                <div class="trust-icon">âš¡</div>
                <h4 class="trust-title">AccÃ¨s InstantanÃ©</h4>
                <p class="trust-text">Activation immÃ©diate</p>
            </div>
            <div class="trust-item">
                <div class="trust-icon">ğŸ“</div>
                <h4 class="trust-title">Expertise</h4>
                <p class="trust-text">Outils & contenus mis Ã  jour</p>
            </div>
        </div>
    </aside>

    <!-- FAQ RAPIDE -->
    <section class="quick-faq">
        <h3 class="faq-title">â“ Questions FrÃ©quentes sur l'Abonnement Premium</h3>

        <div class="faq-item">
            <h4 class="faq-question">Que comprend l'abonnement premium Immigration97 ?</h4>
            <p class="faq-answer">
                GÃ©nÃ©rateur CV, photo visa biomÃ©trique, prÃ©paration tests (IELTS/TCF/TEF), guides visa Canada, calculateurs et support.
            </p>
        </div>

        <div class="faq-item">
            <h4 class="faq-question">Comment activer mon abonnement premium ?</h4>
            <p class="faq-answer">
                AprÃ¨s paiement, votre accÃ¨s est activÃ© automatiquement. Vous pouvez aussi activer via un code prÃ©payÃ©.
            </p>
        </div>

        <div class="faq-item">
            <h4 class="faq-question">Puis-je annuler mon abonnement ?</h4>
            <p class="faq-answer">
                Oui. Vous gardez l'accÃ¨s jusqu'Ã  la fin de la pÃ©riode payÃ©e.
            </p>
        </div>
    </section>
</div>
{% endblock %}
