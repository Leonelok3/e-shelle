{% extends "base.html" %}
{% load static %}

{% block body_class %}residence-permanente rp-plan{% endblock %}
{% block app_scope %}residence-permanente{% endblock %}

{% block title %}
Plan dâ€™action RÃ©sidence Permanente â€“ Canada & Australie | Immigration97
{% endblock %}

{% block meta_description %}
Plan dâ€™action RÃ©sidence Permanente Canada et Australie :
Ã©tapes clÃ©s, suivi de progression, documents requis, langues,
stratÃ©gie immigration et accompagnement intelligent avec Immigration97.
{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="{% static 'css/residence_permanente_nav.css' %}">
{% endblock %}

{% block content %}

{% include "permanent_residence/_rp_nav.html" %}


<div class="rp-page-bg">
  <main class="rp-card">

    <!-- ================= HEADER ================= -->
    <div class="rp-header-section">
      <div class="rp-badge">ğŸ¯ Plan dâ€™action RÃ©sidence Permanente</div>

      <h1 class="rp-heading">
        Ton plan dâ€™action pour la RÃ©sidence Permanente
      </h1>

      <p class="rp-subtitle">
        Suis pas Ã  pas les Ã©tapes essentielles pour construire un
        <strong>projet solide de RÃ©sidence Permanente</strong>
        {% if profile.country == "CA" %}au Canada{% elif profile.country == "AU" %}en Australie{% else %}au Canada ou en Australie{% endif %}.
        Ce plan tâ€™aide Ã  structurer tes dÃ©marches, prioriser les actions
        et amÃ©liorer ton dossier immigration.
      </p>
    </div>

    <!-- ================= PROGRESSION ================= -->
    <section class="rp-progress-box">
      <div class="rp-progress-label">Progression globale de ton projet RP</div>

      <div class="rp-progress-text">
        Chaque Ã©tape complÃ©tÃ©e augmente ton taux dâ€™avancement.
        Mets Ã  jour le statut de chaque action pour suivre
        prÃ©cisÃ©ment ta progression vers la RÃ©sidence Permanente.
      </div>

      <div class="rp-progress-bar">
        <div class="rp-progress-fill" style="width: {{ progress_pct }}%;"></div>
      </div>

      <div class="rp-progress-value">
        <strong>{{ progress_pct }}</strong> <span>% complÃ©tÃ©</span>
      </div>

      <!-- ================= FILTRES ================= -->
      <div class="rp-tabs">
        {% with base="/pr/plan/"|add:profile.id|stringformat:"s"|add:"/" %}
          <a href="{{ base }}?category=all"
             class="rp-tab {% if category == 'all' %}rp-tab--active{% endif %}">
            ğŸ“‹ Toutes les Ã©tapes
          </a>
          <a href="{{ base }}?category=canada"
             class="rp-tab {% if category == 'canada' %}rp-tab--active{% endif %}">
            ğŸ‡¨ğŸ‡¦ Canada
          </a>
          <a href="{{ base }}?category=australia"
             class="rp-tab {% if category == 'australia' %}rp-tab--active{% endif %}">
            ğŸ‡¦ğŸ‡º Australie
          </a>
          <a href="{{ base }}?category=languages"
             class="rp-tab {% if category == 'languages' %}rp-tab--active{% endif %}">
            ğŸ—£ï¸ Langues
          </a>
          <a href="{{ base }}?category=documents"
             class="rp-tab {% if category == 'documents' %}rp-tab--active{% endif %}">
            ğŸ“„ Documents
          </a>
        {% endwith %}
      </div>
    </section>

    <!-- ================= Ã‰TAPES ================= -->
    <section>
      <h2 class="rp-steps-title">
        Ã‰tapes clÃ©s de ton plan dâ€™action RP
      </h2>

      {% for step in steps %}
        <article class="rp-step-card status-{{ step.status }}">
          <header class="rp-step-header">

            <div>
              <div class="rp-step-meta">
                Ã‰tape {{ step.order }} Â·
                {% if step.category == "canada" %}ğŸ‡¨ğŸ‡¦ Canada
                {% elif step.category == "australia" %}ğŸ‡¦ğŸ‡º Australie
                {% elif step.category == "languages" %}ğŸ—£ï¸ Langues
                {% elif step.category == "documents" %}ğŸ“„ Documents
                {% else %}ğŸ“Œ GÃ©nÃ©ral{% endif %}
              </div>

              <h3 class="rp-step-title">
                {{ step.title }}
              </h3>
            </div>

            <div class="rp-step-actions">
              <a href="#" class="rp-step-btn">
                ğŸ“š Ressources utiles
              </a>

              <form method="post" class="rp-step-status-form">
                {% csrf_token %}
                <input type="hidden" name="step_id" value="{{ step.id }}">
                <select name="status" onchange="this.form.submit()">
                  <option value="todo" {% if step.status == 'todo' %}>Ã€ faire</option>
                  <option value="in_progress" {% if step.status == 'in_progress' %}>En cours</option>
                  <option value="done" {% if step.status == 'done' %}>âœ“ TerminÃ©</option>
                </select>
              </form>
            </div>

          </header>

          <p class="rp-step-desc">
            {{ step.description }}
          </p>

          <span class="rp-step-tag">
            {{ step.category|title }}
          </span>
        </article>
      {% empty %}
        <p class="rp-empty">
          Aucune Ã©tape nâ€™est encore dÃ©finie.
          ComplÃ¨te ton diagnostic pour gÃ©nÃ©rer ton plan RP personnalisÃ©.
        </p>
      {% endfor %}
    </section>

    <!-- ================= SEO LONG FORM ================= -->
    <section class="rp-footer-hint">
      <strong>Ã€ propos du plan dâ€™action RÃ©sidence Permanente :</strong><br>
      Ce plan dâ€™action RP est conÃ§u pour tâ€™aider Ã  comprendre
      les exigences de la RÃ©sidence Permanente au Canada et en Australie,
      organiser tes documents, amÃ©liorer ton score linguistique
      et avancer mÃ©thodiquement dans ton projet dâ€™immigration.
      Il sâ€™agit dâ€™un outil dâ€™aide Ã  la dÃ©cision, basÃ© sur les critÃ¨res
      gÃ©nÃ©raux des programmes dâ€™immigration.
    </section>

  </main>
</div>

{% endblock %}
