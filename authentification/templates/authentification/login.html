{% extends 'base.html' %}

{% block title %}Connexion | E-SHELLE{% endblock %}
{% block meta_description %}Connectez-vous pour accÃ©der Ã  vos services (CV IA, Visa Photo, etc.).{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center bg-gray-50 px-4 py-12">
  <div class="w-full max-w-2xl bg-white rounded-2xl shadow-xl border border-orange-300 p-10">

    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-4xl font-extrabold text-green-700">ğŸ” Connexion sÃ©curisÃ©e</h1>
      <p class="text-base font-semibold text-orange-600 mt-2">ğŸŒŸ AccÃ©dez Ã  vos modules IA et Visa Photo en toute confiance</p>
    </div>

    <!-- Messages -->
    {% if messages %}
      <div class="mb-6 space-y-2">
        {% for message in messages %}
          <div class="text-sm px-4 py-3 rounded-lg border
                      {% if message.tags == 'success' %}bg-green-50 border-green-200 text-green-800
                      {% elif message.tags == 'warning' %}bg-yellow-50 border-yellow-200 text-yellow-800
                      {% elif message.tags == 'error' %}bg-red-50 border-red-200 text-red-800
                      {% else %}bg-orange-50 border-orange-200 text-orange-800{% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    <!-- Form -->
    <form method="post" action="{% url 'authentification:login' %}" class="space-y-6">
      {% csrf_token %}
      {% if request.GET.next %}
        <input type="hidden" name="next" value="{{ request.GET.next }}">
      {% elif next %}
        <input type="hidden" name="next" value="{{ next }}">
      {% endif %}

      <div>
        <label for="username" class="block text-sm font-medium text-green-800">ğŸ‘¤ Nom d'utilisateur</label>
        <input type="text" name="username" id="username" value="{{ username|default:'' }}"
               placeholder="Votre nom d'utilisateur" required
               class="mt-1 block w-full rounded-lg border-gray-300 focus:ring-orange-500 focus:border-orange-500 px-4 py-3 text-gray-900">
      </div>

      <div>
        <label for="password" class="block text-sm font-medium text-green-800">ğŸ”’ Mot de passe</label>
        <input type="password" name="password" id="password" placeholder="Votre mot de passe" required
               class="mt-1 block w-full rounded-lg border-gray-300 focus:ring-orange-500 focus:border-orange-500 px-4 py-3 text-gray-900">
      </div>

      <button type="submit"
              class="w-full inline-flex justify-center items-center px-6 py-3 rounded-lg bg-orange-600 text-white font-bold hover:bg-orange-500 transition">
        âœ… Se connecter
      </button>
    </form>

    <!-- Footer -->
    <div class="mt-6 flex flex-col sm:flex-row items-center justify-between text-sm text-gray-700 gap-2">
      <a href="{% url 'authentification:password_reset' %}" class="text-orange-600 hover:text-orange-500 font-semibold">Mot de passe oubliÃ© ?</a>
      <a href="{% url 'authentification:register' %}" class="text-orange-600 hover:text-orange-500 font-semibold">CrÃ©er un compte</a>
    </div>

    {% if user.is_authenticated %}
      <form method="post" action="{% url 'authentification:logout' %}" class="mt-4 text-center">
        {% csrf_token %}
        <button type="submit" class="text-orange-600 hover:text-orange-500 font-semibold">ğŸ”“ Se dÃ©connecter</button>
      </form>
    {% endif %}

    <!-- Resend Activation -->
    <div class="mt-8 border-t pt-4">
      <p class="text-sm text-gray-700 text-center mb-2">Vous n'avez pas reÃ§u l'email de confirmation ?</p>
      <form method="post" action="{% url 'authentification:resend_activation' %}" class="flex flex-col sm:flex-row gap-3 justify-center">
        {% csrf_token %}
        <input type="email" name="email" placeholder="Votre adresse email" required
               class="flex-1 rounded-lg border-gray-300 focus:ring-orange-500 focus:border-orange-500 px-4 py-3 text-gray-900">
        <button type="submit"
                class="px-4 py-3 rounded-lg bg-orange-600 text-white text-sm font-bold hover:bg-orange-500">
          ğŸ” Renvoyer
        </button>
      </form>
    </div>
  </div>
</div>
{% endblock %}
