{% extends "visaetude/base.html" %}

{% block title %}{{ country }} ‚Äì Visa √âtudes{% endblock %}

{% block content %}
    <div class="container">
        <div class="row g-4">
            <!-- Colonne principale - Guide pays -->
            <div class="col-lg-8">
                <div class="card card-module p-4">
                    <div class="section-title mb-1">Guide pays</div>
                    <h1 class="h4 text-white mb-3">√âtudier en {{ country }}</h1>

                    <!-- Onglets pour Admission, Visa √©tudiant, Bourses -->
                    <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active btn-sm" id="pills-admission-tab" data-bs-toggle="pill"
                                    data-bs-target="#pills-admission" type="button" role="tab">
                                Admission
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link btn-sm" id="pills-visa-tab" data-bs-toggle="pill"
                                    data-bs-target="#pills-visa" type="button" role="tab">
                                Visa √©tudiant
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link btn-sm" id="pills-bourse-tab" data-bs-toggle="pill"
                                    data-bs-target="#pills-bourse" type="button" role="tab">
                                Bourses
                            </button>
                        </li>
                    </ul>

                    <!-- Contenu des onglets -->
                    <div class="tab-content small text-muted" id="pills-tabContent">
                        <!-- Onglet Admission -->
                        <div class="tab-pane fade show active" id="pills-admission" role="tabpanel">
                            <p>{{ guide }}</p>
                            <ul>
                                <li>Conditions d‚Äôadmission (niveau d‚Äô√©tudes, moyenne, pr√©requis).</li>
                                <li>Calendrier acad√©mique & dates limites.</li>
                                <li>Langue d‚Äôenseignement (fran√ßais / anglais / autre).</li>
                                <li>Exemples de programmes accessibles.</li>
                            </ul>
                            <p class="mt-3">
                                üé• <strong>Vid√©os admission :</strong> plus bas, tu trouveras des tutoriels pour faire ta demande d‚Äôadmission toi-m√™me.
                            </p>
                        </div>

                        <!-- Onglet Visa -->
                        <div class="tab-pane fade" id="pills-visa" role="tabpanel">
                            <p>Aper√ßu des grandes √©tapes du visa √©tudiant pour {{ country }} :</p>
                            <ol>
                                <li>Obtenir une lettre d‚Äôacceptation officielle.</li>
                                <li>Pr√©parer preuves financi√®res et justificatifs acad√©miques.</li>
                                <li>Remplir le formulaire de demande de visa sur le site officiel.</li>
                                <li>Prendre rendez-vous et d√©poser le dossier.</li>
                                <li>Suivre la demande et pr√©parer le d√©part.</li>
                            </ol>
                            <p class="mt-2">
                                ‚ö†Ô∏è V√©rifie toujours les exigences √† jour sur le site officiel du gouvernement de {{ country }}.
                            </p>
                            <p class="mt-2">
                                üé• <strong>Vid√©os visa :</strong> plus bas, tu auras les captures et vid√©os qui montrent chaque √©tape (formulaire, RDV, d√©p√¥t).
                            </p>
                        </div>

                        <!-- Onglet Bourses -->
                        <div class="tab-pane fade" id="pills-bourse" role="tabpanel">
                            <p>Principales cat√©gories de bourses pour {{ country }} :</p>
                            <ul>
                                <li>Bourses gouvernementales.</li>
                                <li>Bourses des universit√©s.</li>
                                <li>Bourses d‚Äôorganisations internationales.</li>
                            </ul>
                            <p>
                                Le coach IA peut t‚Äôaider √† r√©diger CV & lettres adapt√©es pour maximiser tes chances.
                            </p>
                            <p class="mt-2">
                                üé• <strong>Vid√©os bourses :</strong> plus bas, des tutoriels pour remplir les formulaires et soumettre les dossiers.
                            </p>
                        </div>
                    </div>

                    <hr class="my-4">

                    <!-- RESSOURCES VID√âOS / PDF / CAPTURES -->
                    <div id="resources">
                        <div class="section-title mb-1">Ressources vid√©o & tutoriels pas √† pas</div>
                        <h2 class="h6 text-white mb-2">Fais toi-m√™me les d√©marches en suivant les vid√©os</h2>

                        {% if resources %}
                            <ul class="list-unstyled resources-list">
                                {% for r in resources %}
                                    <li class="resource-item">
                                        <div class="d-flex justify-content-between align-items-start">
                                            <div>
                                                <div class="small text-uppercase text-muted mb-1">
                                                    {{ r.get_category_display }} ¬∑ {{ r.get_resource_type_display }}
                                                </div>
                                                <div class="fw-semibold text-white">{{ r.title }}</div>
                                                {% if r.step_label %}
                                                    <div class="small text-muted">{{ r.step_label }}</div>
                                                {% endif %}
                                            </div>
                                            <a href="{{ r.url }}" target="_blank" rel="noopener"
                                               class="btn btn-soft-success btn-sm ms-2">
                                                Ouvrir
                                            </a>
                                        </div>
                                    </li>
                                {% endfor %}
                            </ul>
                        {% else %}
                            <p class="small text-muted mb-0">
                                Aucune ressource n‚Äôest encore ajout√©e pour {{ country }}.
                                Ton √©quipe pourra bient√¥t ajouter des vid√©os, captures d‚Äô√©cran et PDF
                                depuis l‚Äôespace d‚Äôadministration.
                            </p>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Colonne droite r√©sum√© -->
            <div class="col-lg-4">
                <div class="card card-module p-3 mb-3">
                    <div class="section-title mb-1">Profil conseill√©</div>
                    <p class="small text-muted mb-2">
                        Tu auras les meilleures chances si ton projet est coh√©rent avec :
                    </p>
                    <ul class="small text-muted mb-0">
                        <li>Niveau d‚Äô√©tudes compatible avec les exigences locales.</li>
                        <li>Budget ou bourse adapt√©s au co√ªt de la vie.</li>
                        <li>Niveau de langue suffisant pour suivre les cours.</li>
                    </ul>
                </div>

                <div class="card card-module p-3">
                    <div class="section-title mb-1">Actions suivantes</div>
                    <p class="small text-muted mb-2">
                        Tu peux maintenant int√©grer {{ country }} dans ton plan et g√©n√©rer une checklist personnalis√©e.
                    </p>
                    <a href="{% url 'visaetude:roadmap' %}" class="btn btn-soft-success w-100 mb-2">
                        Ajouter √† mon parcours
                    </a>
                    <a href="#resources" class="btn btn-outline-light btn-sm w-100 mb-2">
                        Voir les vid√©os √©tape par √©tape
                    </a>
                    <a href="{% url 'visaetude:coach_ai' %}" class="btn btn-outline-light btn-sm w-100">
                        Poser une question au coach IA
                    </a>
                </div>
            </div>
        </div>

        <!-- Affichage des universit√©s -->
        <h3>Universit√©s</h3>
        <ul>
            {% for university in universities %}
                <li>
                    <strong>{{ university.name }}</strong>
                    <br>
                    <a href="{{ university.admission_link }}" target="_blank">Commencer la demande d'admission</a>
                    <br>
                    <span>{{ university.advice }}</span>
                </li>
            {% empty %}
                <li>Aucune universit√© n'est list√©e pour ce pays.</li>
            {% endfor %}
        </ul>

        <!-- Affichage des conseils sp√©cifiques -->
        <h3>Conseils pour {{ country }}</h3>
        <ul>
            {% for advice in advices %}
                <li><strong>{{ advice.advice_title }}</strong>: {{ advice.advice_content }}</li>
            {% empty %}
                <li>Aucun conseil disponible pour ce pays.</li>
            {% endfor %}
        </ul>

        <!-- Affichage des bourses -->
        <h3>Bourses d‚Äô√©tudes disponibles</h3>
        <ul>
            {% for scholarship in scholarships %}
                <li>
                    <strong>{{ scholarship.scholarship_name }}</strong> - {{ scholarship.description }}
                    <br>
                    <a href="{{ scholarship.application_link }}" target="_blank">Postuler</a>
                </li>
            {% empty %}
                <li>Aucune bourse n'est disponible pour ce pays.</li>
            {% endfor %}
        </ul>

        <a href="{% url 'visaetude:countries_list' %}">Retour √† la liste des pays</a>
    </div>
{% endblock %}
