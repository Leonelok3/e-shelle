{% extends "base.html" %}
{% load static %}

{% block body_class %}visa-travail{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/visa_travail.css' %}">
{% endblock %}

{% block content %}
<section class="vt-results">

  <div class="container">

    <!-- ================= HEADER ================= -->
    <section class="vt-results-header vt-card vt-fade-up">
      <span class="vt-badge">
        <i class="bi bi-search-heart"></i>
        R√©sultats de ton diagnostic Visa Travail
      </span>

      <h1 class="vt-title">
        Tes
        <span class="vt-gradient-primary">options de visa travail</span>
        personnalis√©es
      </h1>

      <p class="vt-subtle">
        √Ä partir des informations fournies,
        Immigration97 a identifi√© les
        <strong>programmes de visa travail les plus r√©alistes</strong>
        et adapt√©s √† ton profil professionnel,
        en s‚Äôappuyant exclusivement sur des
        <strong>dispositifs officiels et l√©gaux</strong>.
      </p>
    </section>

    <!-- ================= R√âSUM√â PROFIL ================= -->
    <section class="vt-card-soft vt-fade-up">
      <h2 class="vt-section-subtitle">
        <i class="bi bi-person-check"></i>
        R√©sum√© de ton profil
      </h2>

      <ul class="vt-profile-list">
        <li><span>Pays de r√©sidence</span><strong>{{ profile.pays_residence }}</strong></li>
        <li><span>Pays cibl√©s</span><strong>{{ profile.pays_cibles }}</strong></li>
        <li><span>M√©tier / domaine</span><strong>{{ profile.domaine_metier }}</strong></li>
        <li><span>Niveau d‚Äô√©tudes</span><strong>{{ profile.get_niveau_etudes_display }}</strong></li>
        <li><span>Exp√©rience</span><strong>{{ profile.annees_experience }} an(s)</strong></li>
        <li><span>Langues</span><strong>Anglais {{ profile.niveau_anglais }} ¬∑ {{ profile.niveau_langue_pays }}</strong></li>
        <li><span>Budget</span><strong>{{ profile.get_budget_display }}</strong></li>
        <li><span>Horizon</span><strong>{{ profile.get_horizon_depart_display }}</strong></li>
      </ul>

      <a href="{% url 'visa_travail:profil' %}" class="vt-btn-secondary">
        <i class="bi bi-pencil"></i>
        Modifier mon profil
      </a>
    </section>

    <!-- ================= PROGRAMMES ================= -->
    <section class="vt-programs">
      <h2 class="vt-section-title">
        Programmes de visa travail recommand√©s üéØ
      </h2>

      {% if options %}
        <div class="vt-program-grid">

          {% for opt in options %}
            <article class="vt-program-card vt-fade-up">

              <header class="vt-program-header">
                <span class="vt-badge">{{ opt.pays }}</span>
                <span class="vt-program-level">{{ opt.difficulte }}</span>
                <h3>{{ opt.nom_programme }}</h3>
              </header>

              <p class="vt-subtle">
                {{ opt.profil_cible }}
              </p>

              {% if user_has_premium %}

                <!-- üîì CONTENU PREMIUM -->
                <div class="vt-program-block">
                  <strong>Conditions principales</strong>
                  <ul>
                    {% for c in opt.conditions_principales %}
                      <li>{{ c }}</li>
                    {% endfor %}
                  </ul>
                </div>

                <div class="vt-program-block">
                  <strong>Documents cl√©s requis</strong>
                  <ul>
                    {% for d in opt.documents_cles %}
                      <li>{{ d }}</li>
                    {% endfor %}
                  </ul>
                </div>

                <div class="vt-program-delay">
                  <span>D√©lai estimatif</span>
                  <strong>{{ opt.delai_approx }}</strong>
                </div>

                <a href="{{ opt.lien_officiel }}"
                   target="_blank"
                   rel="noopener"
                   class="vt-link">
                  <i class="bi bi-box-arrow-up-right"></i>
                  Consulter la page officielle
                </a>

              {% else %}

                <!-- üîí PREMIUM LOCK -->
                <div class="vt-premium-lock">
                  <i class="bi bi-lock-fill"></i>
                  <h4>Contenu Premium</h4>
                  <p>
                    Conditions d√©taill√©es, documents requis
                    et d√©lais exacts r√©serv√©s aux membres Premium.
                  </p>

                  <a href="{% url 'billing:access' %}" class="vt-btn-premium">
                    <i class="bi bi-stars"></i>
                    D√©bloquer l‚Äôacc√®s Premium
                  </a>
                </div>

              {% endif %}

            </article>
          {% endfor %}

        </div>
      {% else %}
        <div class="vt-alert-warning">
          Aucun programme de visa travail direct n‚Äôa √©t√© identifi√©.
          <br>
          Une strat√©gie alternative
          <strong>√âtudes ‚Üí Travail</strong>
          ou une optimisation du profil est recommand√©e.
        </div>
      {% endif %}
    </section>

    <!-- ================= CTA FINAL ================= -->
    <section class="vt-next-step vt-fade-up">
      <p class="vt-subtle">
        √âtape suivante : transformer ces options
        en un plan d‚Äôaction concret et structur√©
      </p>

      <a href="{% url 'visa_travail:plan_action' profile.id %}"
         class="vt-btn-primary">
        <i class="bi bi-list-check"></i>
        Acc√©der √† mon plan d‚Äôaction personnalis√©
      </a>
    </section>

  </div>
</section>
{% endblock %}
