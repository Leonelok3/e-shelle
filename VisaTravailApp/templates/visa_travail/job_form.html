{% extends "base.html" %}
{% load static %}

{% block body_class %}visa-travail{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/visa_travail.css' %}">
{% endblock %}

{% block content %}
<section class="vt-job-form">

  <div class="container">

    <!-- ==================================================
         HEADER
    =================================================== -->
    <header class="vt-card vt-fade-up vt-job-form-header">

      <span class="vt-badge">
        <i class="bi bi-briefcase"></i>
        Candidature Visa Travail
      </span>

      <h1 class="vt-title">
        {% if is_edit %}
          Modifier une
        {% else %}
          Ajouter une
        {% endif %}
        <span class="vt-gradient-primary">
          candidature visa travail
        </span>
      </h1>

      <p class="vt-subtle">
        Centralise, organise et pilote toutes tes
        <strong>candidatures à l’international</strong>
        afin d’augmenter concrètement
        tes chances d’obtenir un
        <strong>visa travail légal</strong>.
      </p>

    </header>

    <!-- ==================================================
         CONTEXTE
    =================================================== -->
    {% if offer %}
      <div class="vt-card vt-info-box vt-fade-up">
        <strong>Offre associée :</strong>
        {{ offer.titre }}
        {% if offer.entreprise %} — {{ offer.entreprise }}{% endif %}
        ({{ offer.pays }}{% if offer.ville %}, {{ offer.ville }}{% endif %})
      </div>
    {% elif profile %}
      <div class="vt-card vt-info-box vt-fade-up">
        <strong>Profil Visa Travail :</strong>
        {{ profile.nom|default:"Profil utilisateur" }}
      </div>
    {% endif %}

    <!-- ==================================================
         FORMULAIRE
    =================================================== -->
    <div class="vt-card vt-fade-up">

      <form method="post" novalidate class="vt-form-grid">
        {% csrf_token %}

        {% if form.user_profile %}
          <div class="vt-field vt-field-full">
            <label>{{ form.user_profile.label }}</label>
            {{ form.user_profile }}
            <small class="vt-hint">
              Associe cette candidature à un
              <strong>profil Visa Travail existant</strong>
              pour un meilleur suivi stratégique.
            </small>
          </div>
        {% endif %}

        <div class="vt-field">
          <label>{{ form.titre_poste.label }} *</label>
          {{ form.titre_poste }}
        </div>

        <div class="vt-field">
          <label>{{ form.entreprise.label }}</label>
          {{ form.entreprise }}
        </div>

        <div class="vt-field">
          <label>{{ form.pays.label }}</label>
          {{ form.pays }}
        </div>

        <div class="vt-field">
          <label>{{ form.ville.label }}</label>
          {{ form.ville }}
        </div>

        <div class="vt-field vt-field-full">
          <label>{{ form.lien_offre.label }}</label>
          {{ form.lien_offre }}
        </div>

        <div class="vt-field vt-field-full">
          <label>{{ form.source.label }}</label>
          {{ form.source }}
          <small class="vt-hint">
            Exemple : LinkedIn, Indeed, site officiel,
            portail gouvernemental, recommandation.
          </small>
        </div>

        <div class="vt-field">
          <label>{{ form.statut.label }}</label>
          {{ form.statut }}
        </div>

        <div class="vt-field">
          <label>{{ form.date_candidature.label }}</label>
          {{ form.date_candidature }}
        </div>

        <div class="vt-field vt-field-full">
          <label>{{ form.commentaire.label }}</label>
          {{ form.commentaire }}
        </div>

        <!-- ==================================================
             ACTIONS
        =================================================== -->
        <div class="vt-form-actions">

          <button type="submit" class="vt-btn-primary">
            {% if is_edit %}
              Enregistrer les modifications
            {% else %}
              Enregistrer la candidature
            {% endif %}
          </button>

          {% if profile %}
            <a href="{% url 'visa_travail:job_list' profile.id %}"
               class="vt-btn-secondary">
              Retour à mes candidatures
            </a>
          {% else %}
            <a href="{% url 'visa_travail:job_offers_list' %}"
               class="vt-btn-secondary">
              Retour aux offres
            </a>
          {% endif %}

        </div>

      </form>

    </div>

  </div>
</section>
{% endblock %}
