{% extends "base.html" %}
{% load static %}

{% block body_class %}visa-travail{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/visa_travail.css' %}">
{% endblock %}

{% block content %}
<section class="vt-offer-detail">

  <div class="container">

    <article class="vt-offer-card vt-fade-up">

      <!-- ==================================================
           LOCALISATION
      =================================================== -->
      <div class="vt-offer-meta">
        <i class="bi bi-geo-alt"></i>
        {{ offer.pays }}{% if offer.ville %} ¬∑ {{ offer.ville }}{% endif %}
      </div>

      <!-- ==================================================
           TITRE SEO
      =================================================== -->
      <h1 class="vt-title">
        {{ offer.titre }}
      </h1>

      {% if offer.entreprise %}
        <div class="vt-offer-company">
          {{ offer.entreprise }}
        </div>
      {% endif %}

      <!-- ==================================================
           BADGES CL√âS
      =================================================== -->
      <div class="vt-offer-badges">
        {% if offer.type_contrat %}
          <span class="vt-badge small">
            {{ offer.get_type_contrat_display }}
          </span>
        {% endif %}

        {% if offer.salaire %}
          <span class="vt-badge small">
            Salaire : {{ offer.salaire }}
          </span>
        {% endif %}

        <span class="vt-badge small">
          Publi√©e le {{ offer.date_publication }}
        </span>
      </div>

      <!-- ==================================================
           MATCH AVEC LE PROFIL
      =================================================== -->
      {% if profile and match %}
        <div class="vt-match-box">

          <div class="vt-match-header">
            <div>
              <span class="vt-match-label">
                Compatibilit√© avec ton profil
                ({{ profile.nom|default:"Profil #"|add:profile.id }})
              </span>

              <div class="vt-match-score">
                {{ match.score }} %
                ¬∑ {{ match.label }}
              </div>
            </div>

            {% if match.pays_match %}
              <span class="vt-badge success small">
                Pays conforme √† ton objectif
              </span>
            {% endif %}
          </div>

          <p class="vt-match-reason">
            {{ match.reason }}
          </p>
        </div>
      {% endif %}

      <!-- ==================================================
           DOMAINE
      =================================================== -->
      {% if offer.domaine %}
        <div class="vt-offer-domain">
          Domaine / m√©tier :
          <strong>{{ offer.domaine }}</strong>
        </div>
      {% endif %}

      <!-- ==================================================
           DESCRIPTION
      =================================================== -->
      <section class="vt-offer-section">
        <h2 class="vt-section-title">
          Description du poste
        </h2>
        <p class="vt-offer-text">
          {{ offer.description }}
        </p>
      </section>

      {% if offer.exigences %}
        <section class="vt-offer-section">
          <h2 class="vt-section-title">
            Profil recherch√© & exigences
          </h2>
          <p class="vt-offer-text">
            {{ offer.exigences }}
          </p>
        </section>
      {% endif %}

      {% if offer.avantages %}
        <section class="vt-offer-section">
          <h2 class="vt-section-title">
            Avantages propos√©s
          </h2>
          <p class="vt-offer-text">
            {{ offer.avantages }}
          </p>
        </section>
      {% endif %}

      <!-- ==================================================
           ACTIONS PRINCIPALES
      =================================================== -->
      <div class="vt-offer-actions">

        {% if offer.lien_candidature %}
          <a href="{{ offer.lien_candidature }}"
             target="_blank"
             rel="noopener"
             class="vt-btn-primary">
            <i class="bi bi-box-arrow-up-right"></i>
            Postuler sur le site officiel
          </a>
        {% endif %}

        {% if profile %}
          <a href="{% url 'visa_travail:job_create_from_offer' offer.id %}?profile={{ profile.id }}"
             class="vt-btn-secondary">
            <i class="bi bi-clipboard-check"></i>
            Ajouter √† mon suivi de candidatures
          </a>
        {% endif %}

        <a href="{% if profile %}
                   {% url 'visa_travail:job_offers_list' %}?profile={{ profile.id }}
                 {% else %}
                   {% url 'visa_travail:job_offers_list' %}
                 {% endif %}"
           class="vt-link">
          ‚Üê Retour aux offres Visa Travail
        </a>

      </div>

      <hr class="vt-divider">

      <!-- ==================================================
           CONSEIL STRAT√âGIQUE
      =================================================== -->
      <div class="vt-offer-tip">
        üí° <strong>Conseil Immigration97</strong><br>
        Ajoute cette offre √† ton
        <strong>tableau de candidatures</strong>
        pour suivre les r√©ponses,
        planifier les relances
        et maximiser tes chances
        d‚Äôobtenir un
        <strong>visa travail l√©gal</strong>.
      </div>

    </article>

  </div>
</section>
{% endblock %}
