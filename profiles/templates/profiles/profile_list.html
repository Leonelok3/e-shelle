{% extends "base.html" %}
{% load static %}

{% block title %}Talents Premium Afrique â†’ Canada & Europe | Immigration97{% endblock %}
{% block meta_description %}
DÃ©couvrez des profils professionnels Premium (CV + portfolio) disponibles pour le Canada et lâ€™Europe.
Recruteurs : filtrez par mÃ©tier et localisation. Candidats : activez Premium pour Ãªtre visible.
{% endblock %}

{% block body_class %}profiles{% endblock %}
{% block app_scope %}profiles{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/profiles.css' %}">
{% endblock %}

{% block content %}

<!-- HERO -->
<section class="p-market-hero">
  <div class="p-market-hero__inner">
    <div class="p-market-hero__left">
      <div class="p-kicker">Talents Premium â€¢ Afrique â€¢ Canada â€¢ Europe</div>
      <h1 class="p-market-hero__title">Profils Premium prÃªts pour lâ€™international</h1>
      <p class="p-market-hero__lead">
        Recruteurs : trouvez des profils qualifiÃ©s (CV + portfolio). Candidats : activez Premium pour rendre votre profil visible
        et recevoir des invitations Ã  entretien.
      </p>

      <div class="p-market-hero__actions">
        {% if user.is_authenticated %}
          <a class="p-btn p-btn--primary" href="{% url 'profiles:my_space' %}">Mon espace</a>

          {% if user.profile %}
            <a class="p-btn p-btn--outline" href="{% url 'profiles:edit' user.profile.pk %}">ComplÃ©ter mon profil</a>
          {% else %}
            <a class="p-btn p-btn--outline" href="{% url 'profiles:my_space' %}">CrÃ©er mon profil</a>
          {% endif %}
        {% else %}
          <a class="p-btn p-btn--primary" href="{% url 'authentification:login' %}">Se connecter</a>
          <a class="p-btn p-btn--outline" href="{% url 'billing:access' %}">AccÃ¨s Premium</a>
        {% endif %}
      </div>

      <div class="p-market-hero__bullets">
        <div class="p-bullet">âœ… Profils Premium vÃ©rifiables</div>
        <div class="p-bullet">ğŸ“ CV + Portfolio (preuves)</div>
        <div class="p-bullet">ğŸŒ MobilitÃ© internationale</div>
      </div>
    </div>

    <div class="p-market-hero__right">
      <div class="p-market-cta">
        <h2 class="p-market-cta__title">Vous recrutez ?</h2>
        <p class="p-market-cta__text">
          Filtrez par mÃ©tier, ville et mots-clÃ©s. SÃ©lectionnez des profils Premium prÃªts pour lâ€™entretien.
        </p>
        <div class="p-market-cta__chips">
          <span class="p-chip">BTP</span>
          <span class="p-chip">SantÃ©</span>
          <span class="p-chip">IT</span>
          <span class="p-chip">ComptabilitÃ©</span>
          <span class="p-chip">HÃ´tellerie</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- FILTERS -->
<section class="p-filters">
  <form class="p-filters__form" method="get" action="{% url 'profiles:list' %}">
    <div class="p-filters__row">
      <div class="p-filters__field">
        <label class="p-label" for="q">Recherche</label>
        <input
          id="q"
          class="p-input"
          type="text"
          name="q"
          value="{{ request.GET.q|default:'' }}"
          placeholder="MÃ©tier, ville, mots-clÃ©sâ€¦"
        >
      </div>

      <div class="p-filters__field">
        <label class="p-label" for="category">MÃ©tier</label>
        <select id="category" class="p-input" name="category">
          <option value="">Tous les mÃ©tiers</option>
          {% for c in categories %}
            <option value="{{ c.slug }}" {% if request.GET.category == c.slug %}selected{% endif %}>
              {{ c.name }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="p-filters__actions">
        <button class="p-btn p-btn--primary" type="submit">Filtrer</button>
        <a class="p-btn p-btn--outline" href="{% url 'profiles:list' %}">RÃ©initialiser</a>
      </div>
    </div>

    <div class="p-filters__hint">
      Conseil recruteur : utilisez des mots-clÃ©s prÃ©cis (ex: â€œSAPâ€, â€œMenuiserieâ€, â€œAide-soignantâ€, â€œSoudeurâ€, â€œBTPâ€, â€œComptabilitÃ©â€).
    </div>
  </form>
</section>

<!-- RESULTS -->
<section class="p-results">
  <div class="p-results__head">
    <h2 class="p-results__title">Talents Premium</h2>
    <div class="p-results__meta">
      {% if page_obj %}
        <span>{{ page_obj.paginator.count }} profil{{ page_obj.paginator.count|pluralize }}</span>
      {% endif %}
    </div>
  </div>

  {% if profiles %}
    <div class="p-cards">
      {% for p in profiles %}
        <article class="p-card p-card--talent">

          <div class="p-card__top">
            <div class="p-avatar">
              {% if p.avatar %}
                <img src="{{ p.avatar.url }}" alt="Photo de {{ p.user.username }}">
              {% else %}
                <div class="p-avatar__fallback">ğŸ‘¤</div>
              {% endif %}
            </div>

            <div class="p-card__id">
              <div class="p-card__name">
                {{ p.user.get_full_name|default:p.user.username }}
              </div>
              <div class="p-card__sub">
                {{ p.category.name|default:"MÃ©tier non dÃ©fini" }} â€¢ {{ p.location|default:"Localisation non prÃ©cisÃ©e" }}
              </div>
            </div>

            <div class="p-card__badges">
              <span class="p-badge p-badge--success">Premium</span>
              <span class="p-badge p-badge--info">Langue {{ p.level }}</span>
            </div>
          </div>

          <div class="p-card__body">
            <div class="p-card__headline">
              {{ p.headline|default:"Titre du profil Ã  complÃ©ter" }}
            </div>
            <div class="p-card__bio">
              {{ p.bio|default:"Bio Ã  complÃ©ter."|truncatechars:160 }}
            </div>

            <div class="p-card__stats">
              <div class="p-stat">
                <div class="p-stat__k">Portfolio</div>
                <div class="p-stat__v">{{ p.portfolio_items.count }} fichier{{ p.portfolio_items.count|pluralize }}</div>
              </div>
              <div class="p-stat">
                <div class="p-stat__k">DisponibilitÃ©</div>
                <div class="p-stat__v">International</div>
              </div>
            </div>
          </div>

          <div class="p-card__actions">

  <a class="p-btn p-btn--primary" href="{% url 'profiles:detail' p.pk %}">
    Voir le profil
  </a>

  <a class="p-btn p-btn--outline" href="{% url 'profiles:detail' p.pk %}#invite">
    Inviter
  </a>

  {% if user.is_authenticated %}
    <form method="post" action="{% url 'profiles:toggle_favorite' p.pk %}" class="p-favForm">
      {% csrf_token %}
      <button class="p-btn p-btn--outline p-btn--icon {% if p.id in fav_ids %}is-fav{% endif %}"
        type="submit"
        aria-label="Ajouter aux favoris">
  â­
</button>
    </form>
  {% endif %}

</div>


        </article>
      {% endfor %}
    </div>

    <!-- PAGINATION -->
    {% if is_paginated %}
      <nav class="p-pagination" aria-label="Pagination">
        {% if page_obj.has_previous %}
          <a class="p-page" href="?page={{ page_obj.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}">â† PrÃ©cÃ©dent</a>
        {% else %}
          <span class="p-page p-page--disabled">â† PrÃ©cÃ©dent</span>
        {% endif %}

        <span class="p-page p-page--current">
          Page {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}
        </span>

        {% if page_obj.has_next %}
          <a class="p-page" href="?page={{ page_obj.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% if request.GET.category %}&category={{ request.GET.category }}{% endif %}">Suivant â†’</a>
        {% else %}
          <span class="p-page p-page--disabled">Suivant â†’</span>
        {% endif %}
      </nav>
    {% endif %}

  {% else %}
    <div class="p-empty">
      <h3>Aucun profil trouvÃ©</h3>
      <p>Essayez une autre recherche (mÃ©tier, ville) ou rÃ©initialisez les filtres.</p>
      <a class="p-btn p-btn--outline" href="{% url 'profiles:list' %}">RÃ©initialiser</a>
    </div>
  {% endif %}
</section>

<!-- SEO GEO -->
<section class="p-seo">
  <div class="p-seo__card">
    <h2>Recruter des talents dâ€™Afrique pour le Canada et lâ€™Europe</h2>
    <p>
      Immigration97 aide Ã  connecter des <strong>profils Premium</strong> (CV + portfolio) aux recruteurs internationaux.
      Notre objectif : rendre la sÃ©lection plus simple, plus fiable et plus rapide, en mettant en avant les preuves de compÃ©tences.
    </p>

    <h3>Talents disponibles : Cameroun, SÃ©nÃ©gal, CÃ´te dâ€™Ivoire, RDCâ€¦</h3>
    <p>
      Que vous recrutiez dans le <strong>BTP</strong>, la <strong>santÃ©</strong>, lâ€™<strong>informatique</strong>,
      lâ€™<strong>hÃ´tellerie</strong> ou la <strong>comptabilitÃ©</strong>, filtrez les profils Premium par mÃ©tier, localisation et mots-clÃ©s.
    </p>

    <h3>Candidats : comment Ãªtre visible par les recruteurs ?</h3>
    <p>
      ComplÃ©tez votre profil, ajoutez un portfolio (CV, rÃ©alisations, recommandations), puis activez lâ€™accÃ¨s Premium
      pour apparaÃ®tre dans la liste des talents et recevoir des invitations Ã  entretien.
    </p>
  </div>
</section>

{% endblock %}
